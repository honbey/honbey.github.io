<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2023-02-15 Wed 22:04 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Lua è¯­è¨€åŸºç¡€</title>
<meta name="author" content="Honbey Zhang" />
<meta name="generator" content="Org Mode" />

                     <!--
                     <link rel="stylesheet" href="../resources/orgmode.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/style.css" type="text/css"/>
                     -->
                     <!--
                     <link rel="stylesheet" href="../resources/src/bigblow_theme/css/htmlize.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/src/bigblow_theme/css/bigblow.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/src/bigblow_theme/css/hideshow.css" type="text/css"/>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery-1.11.0.min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery-ui-1.10.2.min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery.localscroll-min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery.scrollTo-1.4.3.1-min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery.zclip.min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/bigblow.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/hideshow.js"></script>
                     <script type="text/javascript" src="../resources/src/lib/js/jquery.stickytableheaders.min.js"></script>
                     -->
                     <link rel="stylesheet" href="../resources/src/readtheorg_theme/css/htmlize.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/src/readtheorg_theme/css/readtheorg.css" type="text/css"/>
                     <script type="text/javascript" src="../resources/src/lib/js/jquery.min.js"></script>
                     <script type="text/javascript" src="../resources/src/lib/js/bootstrap.min.js"></script>
                     <script type="text/javascript" src="../resources/src/lib/js/jquery.stickytableheaders.min.js"></script>
                     <script type="text/javascript" src="../resources/src/readtheorg_theme/js/readtheorg.js"></script>
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">Lua è¯­è¨€åŸºç¡€</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgf87b003">Lua</a>
<ul>
<li><a href="#orgfe15724">äº¤äº’å¼</a></li>
<li><a href="#org321f74a">æ³¨é‡Š</a></li>
<li><a href="#org5426cb6">æ ‡ç¤ºç¬¦</a></li>
<li><a href="#org5de1fe7">Lua å…³é”®å­—</a></li>
<li><a href="#org67975e7">Lua è¿ç®—ç¬¦</a>
<ul>
<li><a href="#orga29fafb">è¿ç®—ç¬¦ä¼˜å…ˆçº§</a></li>
</ul>
</li>
<li><a href="#org9254920">Lua å˜é‡</a></li>
<li><a href="#org200a2af">Lua è¯­æ³•ç»“æ„</a>
<ul>
<li><a href="#org5a2cb9d">å¾ªç¯</a></li>
<li><a href="#orgef63ac9">æµç¨‹æ§åˆ¶</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ID-9380063e-36ea-4175-80ec-8d143dc2c749">Lua æ•°æ®ç±»å‹</a></li>
<li><a href="#ID-2432f320-c6ae-44a4-a886-d801b8674f94">Lua å‡½æ•°</a>
<ul>
<li><a href="#org46ef70c">å¯å˜å‚æ•°</a></li>
</ul>
</li>
<li><a href="#ID-09c26f8e-676d-4c1a-b392-0a4fe169411d">Lua å­—ç¬¦ä¸²</a>
<ul>
<li><a href="#org9c88848">å­—ç¬¦ä¸²æ–¹æ³•</a></li>
<li><a href="#org0f3e492">åŒ¹é…æ¨¡å¼</a></li>
</ul>
</li>
<li><a href="#ID-797f8520-7bfd-42d3-81e8-600c8f05a2df">Lua æ•°ç»„</a>
<ul>
<li><a href="#orgf3daa75">ä¸€ç»´æ•°ç»„</a></li>
<li><a href="#org109bfff">å¤šç»´æ•°ç»„</a></li>
</ul>
</li>
<li><a href="#ID-36033706-44ec-40c9-9f1f-9e52517c7ca4">Lua è¿­ä»£å™¨</a>
<ul>
<li><a href="#org986ab36">æ³›å‹ for è¿­ä»£å™¨</a></li>
<li><a href="#org5dda9c0">æ— çŠ¶æ€çš„è¿­ä»£å™¨</a></li>
<li><a href="#org266469e">å¤šçŠ¶æ€çš„è¿­ä»£å™¨</a></li>
</ul>
</li>
<li><a href="#ID-66bd9f20-0480-4713-8800-fad492574a46">Lua è¡¨ table</a>
<ul>
<li><a href="#org9523389">å¸¸ç”¨æ–¹æ³•</a></li>
</ul>
</li>
<li><a href="#ID-e0a477d7-479c-4aa4-9d00-f7f2b9407be3">Lua æ¨¡å—ä¸åŒ…</a>
<ul>
<li><a href="#org8cb2fb6">require å‡½æ•°</a></li>
<li><a href="#org9177b7f">åŠ è½½æœºåˆ¶</a></li>
<li><a href="#org6105dce">C åŒ…</a></li>
</ul>
</li>
<li><a href="#ID-83e40e27-ad20-4167-9486-d244c010cfc4">Lua å…ƒè¡¨ Metatable</a>
<ul>
<li><a href="#orgfe8b866"><code>__index</code> å…ƒæ–¹æ³•</a></li>
<li><a href="#org99046a8"><code>__newindex</code> å…ƒæ–¹æ³•</a></li>
<li><a href="#orgb10ab09"><code>__call</code> å…ƒæ–¹æ³•</a></li>
<li><a href="#org2639cba"><code>__string</code> å…ƒæ–¹æ³•</a></li>
<li><a href="#org4fddd86">å…¶ä»–å…ƒæ–¹æ³•</a></li>
</ul>
</li>
<li><a href="#ID-1ef86fa1-bec0-428b-b1de-02a53a21fa8e">Lua ååŒç¨‹åº coroutine</a>
<ul>
<li><a href="#org6488042">çº¿ç¨‹å’ŒååŒç¨‹åºåŒºåˆ«</a></li>
<li><a href="#orgedc5aa4">åŸºæœ¬æ–¹æ³•</a></li>
</ul>
</li>
<li><a href="#ID-9f98a4a7-80be-4291-82ea-f383031c724b">Lua I/O</a>
<ul>
<li><a href="#org7cfd633">ç®€å•æ¨¡å¼</a></li>
<li><a href="#org44f7a7c">å®Œå…¨æ¨¡å¼</a></li>
</ul>
</li>
<li><a href="#ID-56dfdc61-5be3-40b1-8825-c2523bb2f006">Lua é”™è¯¯å¤„ç†</a>
<ul>
<li><a href="#org526fa33">assert()</a></li>
<li><a href="#orgddac02b">error()</a></li>
<li><a href="#orgffd9c1a">pcall, xpcall</a></li>
<li><a href="#orgc356136">debug åº“</a></li>
</ul>
</li>
<li><a href="#ID-edbcb6f6-313a-4e7a-845d-e70a8184c73c">Lua åƒåœ¾å›æ”¶</a></li>
</ul>
</div>
</nav>

<div id="outline-container-orgf87b003" class="outline-2">
<h2 id="orgf87b003">Lua</h2>
<div class="outline-text-2" id="text-orgf87b003">
<p>
TOC:
</p>
<ul class="org-ul">
<li><a href="#ID-9380063e-36ea-4175-80ec-8d143dc2c749">Lua æ•°æ®ç±»å‹</a></li>
<li><a href="#ID-2432f320-c6ae-44a4-a886-d801b8674f94">Lua å‡½æ•°</a></li>
<li><a href="#ID-09c26f8e-676d-4c1a-b392-0a4fe169411d">Lua å­—ç¬¦ä¸²</a></li>
<li><a href="#ID-797f8520-7bfd-42d3-81e8-600c8f05a2df">Lua æ•°ç»„</a></li>
<li><a href="#ID-36033706-44ec-40c9-9f1f-9e52517c7ca4">Lua è¿­ä»£å™¨</a></li>
<li><a href="#ID-66bd9f20-0480-4713-8800-fad492574a46">Lua è¡¨ table</a></li>
<li><a href="#ID-83e40e27-ad20-4167-9486-d244c010cfc4">Lua å…ƒè¡¨ Metatable</a></li>
<li><a href="#ID-e0a477d7-479c-4aa4-9d00-f7f2b9407be3">Lua æ¨¡å—ä¸åŒ…</a></li>
<li><a href="#ID-1ef86fa1-bec0-428b-b1de-02a53a21fa8e">Lua ååŒç¨‹åº coroutine</a></li>
<li><a href="#ID-9f98a4a7-80be-4291-82ea-f383031c724b">Lua I/O</a></li>
<li><a href="#ID-56dfdc61-5be3-40b1-8825-c2523bb2f006">Lua é”™è¯¯å¤„ç†</a></li>
<li><a href="#ID-edbcb6f6-313a-4e7a-845d-e70a8184c73c">Lua åƒåœ¾å›æ”¶</a></li>
</ul>

<p>
åº”ç”¨ï¼š
</p>
<ul class="org-ul">
<li><a href="install_lua_resty_waf.html#ID-f30d98cd-d9d7-480b-987b-451979c1adb1">å®‰è£…ä½¿ç”¨ lua-resty-waf</a></li>
</ul>

<p>
åŸºäº C çš„è„šæœ¬è¯­è¨€ã€‚
</p>
</div>

<div id="outline-container-orgfe15724" class="outline-3">
<h3 id="orgfe15724">äº¤äº’å¼</h3>
<div class="outline-text-3" id="text-orgfe15724">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #006DAF;">lua</span>
<span style="color: #8D8D84; font-style: italic;"># or</span>
<span style="color: #006DAF;">lua</span> <span style="color: #D0372D;">-i</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org321f74a" class="outline-3">
<h3 id="org321f74a">æ³¨é‡Š</h3>
<div class="outline-text-3" id="text-org321f74a">
<p>
ç‰¹ä¾‹ï¼šshebang <code>#~/usr/bin/env lua</code>
</p>

<p>
å•è¡Œæ³¨é‡Šï¼š
</p>
<div class="org-src-container">
<pre class="src src-lua"><span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#27880;&#37322;</span>
</pre>
</div>

<p>
å¤šè¡Œæ³¨é‡Šï¼š
</p>
<div class="org-src-container">
<pre class="src src-lua"><span style="color: #8D8D84;">--</span><span style="color: #8D8D84; font-style: italic;">[[</span>
<span style="color: #8D8D84; font-style: italic;">  &#27880;&#37322; [a]...</span>
<span style="color: #8D8D84; font-style: italic;">  &#27880;&#37322;</span>
<span style="color: #8D8D84; font-style: italic;">--]]</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5426cb6" class="outline-3">
<h3 id="org5426cb6">æ ‡ç¤ºç¬¦</h3>
<div class="outline-text-3" id="text-org5426cb6">
<p>
å®šä¹‰å˜é‡ï¼Œä»¥å­—æ¯ <code>a-zA-Z</code> æˆ–ä¸‹åˆ’çº¿ <code>_</code> å¼€å¤´ï¼Œåæ¥æ•°å­—ã€å­—æ¯ã€ä¸‹åˆ’çº¿ç»„æˆï¼Œä¸å…è®¸ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦å¦‚ <code>@, $, %</code> æ¥å®šä¹‰æ ‡ç¤ºç¬¦ï¼ŒåŒºåˆ†å¤§å°å†™
</p>
</div>
</div>

<div id="outline-container-org5de1fe7" class="outline-3">
<h3 id="org5de1fe7">Lua å…³é”®å­—</h3>
<div class="outline-text-3" id="text-org5de1fe7">
<pre class="example">
| and      | break | do    | else   |
| elseif   | end   | false | for    |
| function | if    | in    | local  |
| nil      | not   | or    | repeat |
| return   | then  | true  | until  |
| while    | goto  |       |        |
</pre>
</div>
</div>
<div id="outline-container-org67975e7" class="outline-3">
<h3 id="org67975e7">Lua è¿ç®—ç¬¦</h3>
<div class="outline-text-3" id="text-org67975e7">
<p>
ç®—æœ¯è¿ç®—ç¬¦ï¼š
</p>
<ul class="org-ul">
<li>+ åŠ æ³•</li>
<li>+ å‡æ³•</li>
<li>* ä¹˜æ³•</li>
<li>/ é™¤æ³•</li>
<li>% å–ä½™</li>
<li>^ ä¹˜å¹‚</li>
<li>- è´Ÿå·</li>
</ul>

<p>
å…³ç³»è¿ç®—ç¬¦ï¼š
</p>
<ul class="org-ul">
<li>== ç­‰äº</li>
<li>~= ä¸ç­‰äº</li>
<li>&gt;</li>
<li>&lt;</li>
<li>&gt;=</li>
<li>&lt;=</li>
</ul>

<p>
é€»è¾‘è¿ç®—ç¬¦ï¼š
</p>
<ul class="org-ul">
<li>and ä¸</li>
<li>or  æˆ–</li>
<li>not é</li>
</ul>

<p>
å…¶ä»–è¿ç®—ç¬¦ï¼š
</p>
<ul class="org-ul">
<li>.. è¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²</li>
<li>#  ä¸€å…ƒè¿ç®—ç¬¦ï¼Œè¿”å›å­—ç¬¦ä¸²æˆ–è¡¨çš„é•¿åº¦</li>
</ul>
</div>

<div id="outline-container-orga29fafb" class="outline-4">
<h4 id="orga29fafb">è¿ç®—ç¬¦ä¼˜å…ˆçº§</h4>
<div class="outline-text-4" id="text-orga29fafb">
<pre class="example">
^
not  - (unary)
/    *         %
+    -
..
&lt;    &gt;        &lt;=  &gt;=  ~=  ==
and
or
</pre>

<p>
é™¤äº† <code>^</code> å’Œ <code>..</code> å¤–æ‰€æœ‰è¿ç®—ç¬¦éƒ½æ˜¯å·¦è¿æ¥çš„
</p>
</div>
</div>
</div>

<div id="outline-container-org9254920" class="outline-3">
<h3 id="org9254920">Lua å˜é‡</h3>
<div class="outline-text-3" id="text-org9254920">
<p>
lua çš„å˜é‡é»˜è®¤éƒ½æ˜¯å…¨å±€å˜é‡ï¼Œé™¤éä½¿ç”¨ local è¿›è¡Œå£°æ˜
</p>

<p>
å…¨å±€å˜é‡ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œå˜é‡æ€»æ˜¯è®¤ä¸ºæ˜¯å…¨å±€çš„ï¼Œæœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡çš„å€¼ä¸º <code>nil</code> ã€‚
</p>

<p>
èµ‹å€¼ï¼šå¯å¯¹å¤šä¸ªå˜é‡åŒæ—¶èµ‹å€¼ï¼Œå„å…ƒç´ ç”¨é€—å· <code>,</code> åˆ†éš”ï¼Œè‹¥å˜é‡ä¸ªæ•°å¤§äºå€¼çš„ä¸ªæ•°ï¼Œè¡¥ nilï¼Œåä¹‹å¿½ç•¥å¤šä½™çš„å€¼
</p>

<p>
ç´¢å¼•ï¼šä½¿ç”¨ <code>[]</code> è¿›è¡Œç´¢å¼•
</p>
</div>
</div>

<div id="outline-container-org200a2af" class="outline-3">
<h3 id="org200a2af">Lua è¯­æ³•ç»“æ„</h3>
<div class="outline-text-3" id="text-org200a2af">
</div>
<div id="outline-container-org5a2cb9d" class="outline-4">
<h4 id="org5a2cb9d">å¾ªç¯</h4>
<div class="outline-text-4" id="text-org5a2cb9d">
<ul class="org-ul">
<li>while</li>
<li>for</li>
<li>repeat until</li>
</ul>

<p>
å¾ªç¯æ§åˆ¶è¯­å¥
</p>
<ul class="org-ul">
<li>break</li>
<li>goto</li>
</ul>

<div class="org-src-container">
<pre class="src src-lua"><span style="color: #0000FF;">while</span> (<span style="color: #D0372D;">true</span>)
<span style="color: #0000FF;">do</span>
  <span style="color: #006FE0;">print</span>(<span style="color: #008000;">"Hello"</span>)
<span style="color: #0000FF;">end</span>

<span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">Label</span>
<span style="color: #D0372D;">::Label::</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-lua"><span style="color: #0000FF;">for</span> <span style="color: #BA36A5;">i</span>=<span style="color: #D0372D;">10</span>, <span style="color: #D0372D;">1</span>, -<span style="color: #D0372D;">1</span> <span style="color: #0000FF;">do</span>
  <span style="color: #006FE0;">print</span>(i)
<span style="color: #0000FF;">end</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgef63ac9" class="outline-4">
<h4 id="orgef63ac9">æµç¨‹æ§åˆ¶</h4>
<div class="outline-text-4" id="text-orgef63ac9">
<ul class="org-ul">
<li>if elseif else</li>
</ul>

<div class="org-src-container">
<pre class="src src-lua"><span style="color: #0000FF;">if</span> (f == <span style="color: #D0372D;">1</span>)
<span style="color: #0000FF;">then</span>
  code
<span style="color: #0000FF;">elseif</span>
<span style="color: #0000FF;">then</span>
  code
<span style="color: #0000FF;">else</span>
  code
<span style="color: #0000FF;">end</span>
</pre>
</div>
</div>
</div>
</div>
</div>


<div id="outline-container-ID-9380063e-36ea-4175-80ec-8d143dc2c749" class="outline-2">
<h2 id="ID-9380063e-36ea-4175-80ec-8d143dc2c749">Lua æ•°æ®ç±»å‹</h2>
<div class="outline-text-2" id="text-ID-9380063e-36ea-4175-80ec-8d143dc2c749">
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">æ•°æ®ç±»å‹</th>
<th scope="col" class="org-left">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">nil</td>
<td class="org-left">æ ‡ç¤ºæ— æ•ˆå€¼ï¼Œé€»è¾‘åˆ¤æ–­ä¸º false</td>
</tr>

<tr>
<td class="org-left">boolean</td>
<td class="org-left">å¸ƒå°”å€¼ï¼Œtrue / false</td>
</tr>

<tr>
<td class="org-left">number</td>
<td class="org-left">åŒç²¾åº¦å®æµ®ç‚¹æ•°</td>
</tr>

<tr>
<td class="org-left">string</td>
<td class="org-left">å•å¼•å·æˆ–åŒå¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²</td>
</tr>

<tr>
<td class="org-left">function</td>
<td class="org-left">ç”± C æˆ– lua ç¼–å†™çš„å‡½æ•°</td>
</tr>

<tr>
<td class="org-left">userdata</td>
<td class="org-left">ä»»æ„å­˜å‚¨åœ¨å˜é‡ä¸­çš„ C æ•°æ®ç»“æ„</td>
</tr>

<tr>
<td class="org-left">thread</td>
<td class="org-left">æ ‡ç¤ºæ‰§è¡Œçš„ç‹¬ç«‹çº¿ç¨‹</td>
</tr>

<tr>
<td class="org-left">table</td>
<td class="org-left">å…³è”æ•°ç»„ associative arrays, {}</td>
</tr>
</tbody>
</table>

<blockquote>
<p>
<b>nil ä½œæ¯”è¾ƒæ—¶åº”è¯¥åŠ ä¸ŠåŒå¼•å·</b>
</p>
</blockquote>
</div>
</div>

<div id="outline-container-ID-2432f320-c6ae-44a4-a886-d801b8674f94" class="outline-2">
<h2 id="ID-2432f320-c6ae-44a4-a886-d801b8674f94">Lua å‡½æ•°</h2>
<div class="outline-text-2" id="text-ID-2432f320-c6ae-44a4-a886-d801b8674f94">
<div class="org-src-container">
<pre class="src src-lua">optional_function_scope <span style="color: #0000FF;">function</span> <span style="color: #006699;">function_name</span>( <span style="color: #BA36A5;">argument1</span>, <span style="color: #BA36A5;">argument2</span>, <span style="color: #BA36A5;">argument3</span>..., argumentn)
  function_body
  <span style="color: #0000FF;">return</span> result_params_comma_separated
<span style="color: #0000FF;">end</span>
</pre>
</div>

<p>
optional<sub>function</sub><sub>scope</sub>: æŒ‡å®šå…¨å±€è¿˜æ˜¯å±€éƒ¨ï¼Œé»˜è®¤å…¨å±€ï¼Œä½¿ç”¨ local æŒ‡å®šä¸ºå±€éƒ¨
</p>
</div>

<div id="outline-container-org46ef70c" class="outline-3">
<h3 id="org46ef70c">å¯å˜å‚æ•°</h3>
<div class="outline-text-3" id="text-org46ef70c">
<p>
åœ¨å‡½æ•°åˆ—è¡¨ä¸­ä½¿ç”¨ä¸‰ç‚¹ <code>...</code> è¡¨ç¤ºå‡½æ•°æœ‰å¯å˜çš„å‚æ•°ï¼Œåœ¨å‡½æ•°ä¸­ä½¿ç”¨ <code>{...}</code> è¡¨ç¤ºç”±æ‰€æœ‰å˜é•¿å‚æ•°æ„æˆçš„æ•°ç»„ï¼Œä¹Ÿå¯ä½¿ç”¨ <code>select("#", ...)</code> æ¥è·å–å¯å˜å‚æ•°çš„æ•°é‡ï¼Œ <code>select(n, ...)</code> è¿”å›ä»èµ·ç‚¹ n å¼€å§‹åˆ°ç»“æŸä½ç½®çš„æ‰€æœ‰å‚æ•°åˆ—è¡¨ï¼Œå›ºå®šå‚æ•°å¿…é¡»æ”¾åœ¨å˜é•¿å‚æ•°ä¹‹å‰ã€‚
</p>
</div>
</div>
</div>


<div id="outline-container-ID-09c26f8e-676d-4c1a-b392-0a4fe169411d" class="outline-2">
<h2 id="ID-09c26f8e-676d-4c1a-b392-0a4fe169411d">Lua å­—ç¬¦ä¸²</h2>
<div class="outline-text-2" id="text-ID-09c26f8e-676d-4c1a-b392-0a4fe169411d">
<p>
è¡¨ç¤ºæ–¹æ³•ï¼š
</p>
<ul class="org-ul">
<li>å•å¼•å· <code>''</code></li>
<li>åŒå¼•å· <code>""</code></li>
<li>åŒä¸­æ‹¬å· <code>[[]]</code></li>
</ul>

<p>
è½¬ä¹‰å­—ç¬¦åŒ C è¯­è¨€
</p>
</div>

<div id="outline-container-org9c88848" class="outline-3">
<h3 id="org9c88848">å­—ç¬¦ä¸²æ–¹æ³•</h3>
<div class="outline-text-3" id="text-org9c88848">
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">æ–¹æ³•</th>
<th scope="col" class="org-left">å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">string.upper(argument)</td>
<td class="org-left">å°†å­—ç¬¦ä¸²å…¨éƒ¨è½¬æ¢ä¸ºå¤§å†™</td>
</tr>

<tr>
<td class="org-left">string.lower(argument)</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">string.gsub(str, substr, replace, num)</td>
<td class="org-left">æ›¿æ¢</td>
</tr>

<tr>
<td class="org-left">string.find(str, substr[, init, [end]])</td>
<td class="org-left">æœç´¢</td>
</tr>

<tr>
<td class="org-left">string.reverse(argument)</td>
<td class="org-left">åè½¬</td>
</tr>

<tr>
<td class="org-left">string.format(&#x2026;)</td>
<td class="org-left">è¿”å›ä¸€ä¸ªç±»ä¼¼ printf çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²</td>
</tr>

<tr>
<td class="org-left">string.char(argument)</td>
<td class="org-left">å°†æ•´å‹æ•°å­—è½¬ä¸ºå­—ç¬¦å¹¶è¿æ¥</td>
</tr>

<tr>
<td class="org-left">string.byte(argument[, int])</td>
<td class="org-left">è½¬æ¢å­—ç¬¦ä¸ºæ•´æ•°å€¼</td>
</tr>

<tr>
<td class="org-left">string.len(str)</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">string.rep(str, n)</td>
<td class="org-left">è¿”å› n ä¸ª str çš„æ‹·è´</td>
</tr>

<tr>
<td class="org-left">..</td>
<td class="org-left">è¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²</td>
</tr>

<tr>
<td class="org-left">string.gmatch(str, pattern)</td>
<td class="org-left">è¿”å›ä¸€ä¸ªè¿­ä»£å™¨å‡½æ•°ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°è¿”å›ç›¸åº”å­ä¸²ï¼Œæ— åˆ™ nil</td>
</tr>

<tr>
<td class="org-left">string.match(str, pattern, init)</td>
<td class="org-left">æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€ä¸ªåŒ¹é…</td>
</tr>

<tr>
<td class="org-left">string.sub(str, init[, end])</td>
<td class="org-left">æˆªå–</td>
</tr>
</tbody>
</table>

<p>
<code>string.format(...)</code> å‡½æ•°ç±»ä¼¼ <code>printf(...)</code> å‡½æ•°ï¼Œè½¬ä¹‰ç åŸºæœ¬ç›¸åŒ
</p>
</div>
</div>

<div id="outline-container-org0f3e492" class="outline-3">
<h3 id="org0f3e492">åŒ¹é…æ¨¡å¼</h3>
<div class="outline-text-3" id="text-org0f3e492">
<p>
å•ä¸ªå­—ç¬¦ä¸å…¶è‡ªèº«åŒ¹é… (é™¤ <code>^$()%*+-?</code> å¤–)
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">å­—ç¬¦ç±»</th>
<th scope="col" class="org-left">å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>.</code></td>
<td class="org-left">ä¸ä»»ä½•å­—ç¬¦åŒ¹é…</td>
</tr>

<tr>
<td class="org-left"><code>%a</code></td>
<td class="org-left">å­—æ¯</td>
</tr>

<tr>
<td class="org-left"><code>%c</code></td>
<td class="org-left">æ§åˆ¶ç¬¦</td>
</tr>

<tr>
<td class="org-left"><code>%d</code></td>
<td class="org-left">æ•°å­—</td>
</tr>

<tr>
<td class="org-left"><code>%l</code></td>
<td class="org-left">å°å†™å­—æ¯</td>
</tr>

<tr>
<td class="org-left"><code>%p</code></td>
<td class="org-left">æ ‡ç‚¹ punctuation</td>
</tr>

<tr>
<td class="org-left"><code>%s</code></td>
<td class="org-left">ç©ºç™½å­—ç¬¦</td>
</tr>

<tr>
<td class="org-left"><code>%u</code></td>
<td class="org-left">å¤§å†™å­—æ¯</td>
</tr>

<tr>
<td class="org-left"><code>%w</code></td>
<td class="org-left">å­—æ¯/æ•°å­—</td>
</tr>

<tr>
<td class="org-left"><code>%x</code></td>
<td class="org-left">åå…­è¿›åˆ¶</td>
</tr>

<tr>
<td class="org-left"><code>%z</code></td>
<td class="org-left">è¡¨é›¶å­—ç¬¦</td>
</tr>

<tr>
<td class="org-left"><code>%x</code></td>
<td class="org-left">è½¬ä¹‰</td>
</tr>

<tr>
<td class="org-left"><code>[]</code></td>
<td class="org-left">å­—ç¬¦é›†</td>
</tr>

<tr>
<td class="org-left"><code>[^]</code></td>
<td class="org-left">éå­—ç¬¦é›†</td>
</tr>
</tbody>
</table>

<p>
å¤§å†™ z åŠä¹‹å‰çš„å­—æ¯è¡¨ç¤º <b><b>é</b></b>
</p>

<p>
ç‰¹æ®Šå­—ç¬¦
</p>
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">å­—ç¬¦</th>
<th scope="col" class="org-left">å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>*</code></td>
<td class="org-left">é›¶æˆ–å¤šä¸ªï¼Œè´ªå©ªåŒ¹é…</td>
</tr>

<tr>
<td class="org-left"><code>+</code></td>
<td class="org-left">ä¸€æˆ–å¤šä¸ª</td>
</tr>

<tr>
<td class="org-left"><code>-</code></td>
<td class="org-left">é›¶æˆ–å¤šä¸ªï¼Œæœ€çŸ­åŒ¹é…</td>
</tr>

<tr>
<td class="org-left"><code>?</code></td>
<td class="org-left">é›¶æˆ–ä¸€ä¸ª</td>
</tr>

<tr>
<td class="org-left"><code>%n</code></td>
<td class="org-left">n = 1, 2, &#x2026;, 9 è¡¨ç¤ºç¬¬å‡ ä¸ªåŒ¹é…</td>
</tr>

<tr>
<td class="org-left"><code>%bxy</code></td>
<td class="org-left">x, y ä¸ºå­—ç¬¦ï¼Œä¾‹å¦‚ %b() è¡¨ç¤ºæ‹¬å·å¹³è¡¡çš„è¡¨è¾¾å¼</td>
</tr>

<tr>
<td class="org-left"><code>%f[set]</code></td>
<td class="org-left">è¾¹å¢ƒæ¨¡å¼ï¼ŒåŒ¹é…ä½äº set å†…æŸä¸ªå­—ç¬¦ä¹‹å‰çš„ç©ºä¸²</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-ID-797f8520-7bfd-42d3-81e8-600c8f05a2df" class="outline-2">
<h2 id="ID-797f8520-7bfd-42d3-81e8-600c8f05a2df">Lua æ•°ç»„</h2>
<div class="outline-text-2" id="text-ID-797f8520-7bfd-42d3-81e8-600c8f05a2df">
<p>
<b><b>ç›¸åŒæ•°æ®ç±»å‹æŒ‰ä¸€å®šé¡ºåºæ’åˆ—çš„é›†åˆ</b></b>
</p>
</div>

<div id="outline-container-orgf3daa75" class="outline-3">
<h3 id="orgf3daa75">ä¸€ç»´æ•°ç»„</h3>
<div class="outline-text-3" id="text-orgf3daa75">
<div class="org-src-container">
<pre class="src src-lua">array = { <span style="color: #008000;">"Lua"</span>, <span style="color: #008000;">"Language"</span> }

<span style="color: #0000FF;">for</span> <span style="color: #BA36A5;">i</span> = <span style="color: #D0372D;">0</span>, <span style="color: #D0372D;">2</span> <span style="color: #0000FF;">do</span>
  <span style="color: #006FE0;">print</span>(array[i])
<span style="color: #0000FF;">end</span>
</pre>
</div>

<p>
Lua ç´¢å¼•ä» 1 å¼€å§‹ï¼Œä½†å¯ä»¥æŒ‡å®š 0 å¼€å§‹
</p>
</div>
</div>
<div id="outline-container-org109bfff" class="outline-3">
<h3 id="org109bfff">å¤šç»´æ•°ç»„</h3>
<div class="outline-text-3" id="text-org109bfff">
<p>
å¤šç»´æ•°ç»„å³æ•°ç»„ä¸­åŒ…å«æ•°ç»„æˆ–ä¸€ç»´æ•°ç»„çš„ç´¢å¼•é”®å¯¹åº”ä¸€ä¸ªæ•°ç»„
</p>
</div>
</div>
</div>

<div id="outline-container-ID-36033706-44ec-40c9-9f1f-9e52517c7ca4" class="outline-2">
<h2 id="ID-36033706-44ec-40c9-9f1f-9e52517c7ca4">Lua è¿­ä»£å™¨</h2>
<div class="outline-text-2" id="text-ID-36033706-44ec-40c9-9f1f-9e52517c7ca4">
<p>
è¿­ä»£å™¨ iterator æ˜¯ä¸€ç§å¯¹è±¡ï¼Œèƒ½å¤Ÿç”¨æ¥éå†æ ‡å‡†æ¨¡æ¿åº“å®¹å™¨ä¸­çš„éƒ¨åˆ†æˆ–å…¨éƒ¨å…ƒç´ ï¼Œæ¯ä¸ªè¿­ä»£å¯¹è±¡ä»£è¡¨å®¹å™¨ä¸­çš„ç¡®å®šçš„åœ°å€ï¼ŒLua çš„è¿­ä»£å™¨æ˜¯ä¸€ç§æ”¯æŒæŒ‡é’ˆçš„ç»“æ„ã€‚
</p>
</div>

<div id="outline-container-org986ab36" class="outline-3">
<h3 id="org986ab36">æ³›å‹ for è¿­ä»£å™¨</h3>
<div class="outline-text-3" id="text-org986ab36">
<p>
æ³›å‹ for åœ¨å†…éƒ¨ä¿å­˜è¿­ä»£å‡½æ•°ã€çŠ¶æ€å¸¸é‡ã€æ§åˆ¶å˜é‡
</p>
<div class="org-src-container">
<pre class="src src-lua">array = {<span style="color: #008000;">"a"</span>, <span style="color: #008000;">"b"</span>}

<span style="color: #0000FF;">for</span> <span style="color: #BA36A5;">key</span>, <span style="color: #BA36A5;">value</span> <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">ipairs</span>(array)
<span style="color: #0000FF;">do</span>
  <span style="color: #006FE0;">print</span>(key, value)
<span style="color: #0000FF;">end</span>
</pre>
</div>

<p>
<code>ipairs()</code> æ˜¯ Lua é»˜è®¤æä¾›çš„è¿­ä»£å‡½æ•°ï¼Œ <code>pairs()</code> ä¼šå°† table å‹è½¬ä¸ºä¸€æ•´ä¸ªæ•°ç»„è¿›è¡Œå¤„ç†
</p>
</div>
</div>

<div id="outline-container-org5dda9c0" class="outline-3">
<h3 id="org5dda9c0">æ— çŠ¶æ€çš„è¿­ä»£å™¨</h3>
<div class="outline-text-3" id="text-org5dda9c0">
<p>
æŒ‡ä¸ä¿ç•™ä»»ä½•çŠ¶æ€çš„è¿­ä»£å™¨
</p>

<p>
æ¯ä¸€æ¬¡è¿­ä»£ï¼Œè¿­ä»£å‡½æ•°éƒ½æ˜¯ç”¨ä¸¤ä¸ªå˜é‡ï¼ˆçŠ¶æ€å¸¸é‡å’Œæ§åˆ¶å˜é‡ï¼‰çš„å€¼ä½œä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œä¸€ä¸ªæ— çŠ¶æ€çš„è¿­ä»£å™¨åªåˆ©ç”¨è¿™ä¸¤ä¸ªå€¼å¯ä»¥è·å–ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œä¾‹å¦‚ <code>ipairs()</code> ï¼Œéå†æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå…ƒç´ çš„ç´¢å¼•éœ€è¦æ˜¯æ•°å€¼
</p>

<p>
ğŸŒ°
</p>

<div class="org-src-container">
<pre class="src src-lua"><span style="color: #0000FF;">function</span> <span style="color: #006699;">square</span>(<span style="color: #BA36A5;">iteratorMaxCount</span>, <span style="color: #BA36A5;">currentNumber</span>)
  <span style="color: #0000FF;">if</span> currentNumber &lt; iteratorMaxCount
  <span style="color: #0000FF;">then</span>
    currentNumber = currentNumber + <span style="color: #D0372D;">1</span>
  <span style="color: #0000FF;">return</span> currentNumber, currentNumber ^ <span style="color: #D0372D;">2</span>
  <span style="color: #0000FF;">end</span>
<span style="color: #0000FF;">end</span>

<span style="color: #0000FF;">for</span> <span style="color: #BA36A5;">i</span>, <span style="color: #BA36A5;">n</span> <span style="color: #0000FF;">in</span> square, <span style="color: #D0372D;">3</span>, <span style="color: #D0372D;">0</span>
<span style="color: #0000FF;">do</span>
  <span style="color: #006FE0;">print</span>(i, n)
<span style="color: #0000FF;">end</span>
</pre>
</div>

<p>
ipairs å®ç°ï¼š
</p>

<div class="org-src-container">
<pre class="src src-lua"><span style="color: #0000FF;">function</span> <span style="color: #006699;">iter</span>(<span style="color: #BA36A5;">a</span>, <span style="color: #BA36A5;">i</span>)
  i = i + <span style="color: #D0372D;">1</span>
  <span style="color: #0000FF;">local</span> <span style="color: #BA36A5;">v</span> = a[i]
  <span style="color: #0000FF;">if</span> v <span style="color: #0000FF;">then</span>
    <span style="color: #0000FF;">return</span> i, v
  <span style="color: #0000FF;">end</span>
<span style="color: #0000FF;">end</span>

<span style="color: #0000FF;">function</span> <span style="color: #006FE0;">ipairs</span>(<span style="color: #BA36A5;">a</span>)
  <span style="color: #0000FF;">return</span> iter, a, <span style="color: #D0372D;">0</span>
<span style="color: #0000FF;">end</span>
</pre>
</div>

<p>
å½“ Lua è°ƒç”¨ ipairs(a) å¼€å§‹å¾ªç¯æ—¶ï¼Œä»–è·å–ä¸‰ä¸ªå€¼ï¼šè¿­ä»£å‡½æ•° iterã€çŠ¶æ€å¸¸é‡ aã€æ§åˆ¶å˜é‡åˆå§‹å€¼ 0ï¼›ç„¶å Lua è°ƒç”¨ iter(a, 0) è¿”å› 1, a[1]ï¼ˆé™¤é a[1]=nilï¼‰ï¼›ç¬¬äºŒæ¬¡è¿­ä»£è°ƒç”¨ iter(a,1) è¿”å› 2, a[2]â€¦â€¦ ç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ª nil å…ƒç´ ã€‚
</p>
</div>
</div>

<div id="outline-container-org266469e" class="outline-3">
<h3 id="org266469e">å¤šçŠ¶æ€çš„è¿­ä»£å™¨</h3>
<div class="outline-text-3" id="text-org266469e">
<p>
ä¿å­˜å¤šä¸ªçŠ¶æ€ä¿¡æ¯çš„è¿­ä»£å™¨ï¼Œæœ€ç®€å•æ–¹å¼æ˜¯é—­åŒ…ï¼Œæˆ–è€…å°†æ‰€æœ‰çš„çŠ¶æ€ä¿¡æ¯å°è£…åˆ° è¡¨ table å†…ï¼Œå°† table ä½œä¸ºè¿­ä»£å™¨çš„çŠ¶æ€å¸¸é‡
</p>

<p>
ğŸŒ°
</p>

<div class="org-src-container">
<pre class="src src-lua">array = {<span style="color: #008000;">"a"</span>, <span style="color: #008000;">"b"</span>}

<span style="color: #0000FF;">function</span> <span style="color: #006699;">elementIterator</span>(<span style="color: #BA36A5;">collection</span>)
  <span style="color: #0000FF;">local</span> <span style="color: #BA36A5;">index</span> = <span style="color: #D0372D;">0</span>
  <span style="color: #0000FF;">local</span> <span style="color: #BA36A5;">count</span> = #collection
  <span style="color: #0000FF;">return</span> <span style="color: #0000FF;">function</span>()
    <span style="color: #0000FF;">if</span> index &lt;= count
    <span style="color: #0000FF;">then</span>
      <span style="color: #0000FF;">return</span> collection[index]
    <span style="color: #0000FF;">end</span>
  <span style="color: #0000FF;">end</span>
<span style="color: #0000FF;">end</span>

<span style="color: #0000FF;">for</span> <span style="color: #BA36A5;">element</span> <span style="color: #0000FF;">in</span> elementIterator(array)
<span style="color: #0000FF;">do</span>
  <span style="color: #006FE0;">print</span>(element)
<span style="color: #0000FF;">end</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-ID-66bd9f20-0480-4713-8800-fad492574a46" class="outline-2">
<h2 id="ID-66bd9f20-0480-4713-8800-fad492574a46">Lua è¡¨ table</h2>
<div class="outline-text-2" id="text-ID-66bd9f20-0480-4713-8800-fad492574a46">
<p>
table æ˜¯å…³è”å‹æ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨ä»»æ„ç±»å‹çš„å€¼ï¼ˆé™¤ nilï¼‰ä½œä¸ºæ•°ç»„çš„ç´¢å¼•ï¼ŒåŒæ—¶ Lua é€šè¿‡ table æ¥è§£å†³æ¨¡å— (module), åŒ… (package) å’Œå¯¹è±¡ (Object)çš„
</p>

<p>
é€šè¿‡ <code>{}</code> æ¥æ„é€ ä¸€ä¸ª table
</p>

<div class="org-src-container">
<pre class="src src-lua"><span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#21021;&#22987;&#21270;&#19968;&#20010; table</span>
mytable = {}

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#25351;&#23450;&#26576;&#20010;&#32034;&#24341;&#23545;&#24212;&#30340;&#20540;</span>
mytable[<span style="color: #D0372D;">1</span>] = <span style="color: #008000;">"Lua"</span>

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#31227;&#38500;&#24341;&#29992;</span>
mytable = <span style="color: #D0372D;">nil</span>
<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">lua &#30340; gc &#20250;&#37322;&#25918;&#20869;&#23384;&#65292;&#24341;&#29992;&#35745;&#25968;</span>
</pre>
</div>
</div>

<div id="outline-container-org9523389" class="outline-3">
<h3 id="org9523389">å¸¸ç”¨æ–¹æ³•</h3>
<div class="outline-text-3" id="text-org9523389">
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">æ–¹æ³•</th>
<th scope="col" class="org-left">å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">table.concat(table[, sep[, start[, end]]])</td>
<td class="org-left">concatenateï¼Œåˆ—å‡ºå‚æ•°ä¸­æŒ‡å®šçš„ table çš„æ•°ç»„éƒ¨åˆ†æŒ‡å®šä½ç½®çš„æ‰€æœ‰å…ƒç´ ï¼Œä»¥æŒ‡å®šçš„åˆ†éš”ç¬¦éš”å¼€</td>
</tr>

<tr>
<td class="org-left">table.insert(table, [pos, ] value)</td>
<td class="org-left">åœ¨æ•°ç»„çš„æŒ‡å®šä½ç½®æ’å…¥å€¼ä¸º value çš„å…ƒç´ ï¼Œé»˜è®¤æœ«å°¾</td>
</tr>

<tr>
<td class="org-left">table.maxn(table)</td>
<td class="org-left">æŒ‡å®š table ä¸­æ‰€æœ‰æ­£æ•° key å€¼ä¸­æœ€å¤§çš„ key å€¼ï¼Œlua 5.1 ä¹‹å‰å­˜åœ¨</td>
</tr>

<tr>
<td class="org-left">table.remove(table[, pos])</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">table.sort(table[, comp])</td>
<td class="org-left">å¯¹ table è¿›è¡Œæ’åº</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-lua"><span style="color: #0000FF;">function</span> <span style="color: #006699;">table_maxn</span>(<span style="color: #BA36A5;">t</span>)
  <span style="color: #0000FF;">local</span> <span style="color: #BA36A5;">mn</span> = <span style="color: #D0372D;">nil</span>
  <span style="color: #0000FF;">for</span> <span style="color: #BA36A5;">k</span>, <span style="color: #BA36A5;">v</span> <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">pairs</span>(t) <span style="color: #0000FF;">do</span>
    <span style="color: #0000FF;">if</span> mn == <span style="color: #D0372D;">nil</span> <span style="color: #0000FF;">then</span>
      mn = v
    <span style="color: #0000FF;">end</span>
    <span style="color: #0000FF;">if</span> mn &lt; v <span style="color: #0000FF;">then</span>
      mn = v
    <span style="color: #0000FF;">end</span>
  <span style="color: #0000FF;">end</span>
  <span style="color: #0000FF;">return</span> mn
<span style="color: #0000FF;">end</span>

tbl = {[<span style="color: #D0372D;">1</span>] = <span style="color: #D0372D;">2</span>, [<span style="color: #D0372D;">2</span>] = <span style="color: #D0372D;">6</span>, [<span style="color: #D0372D;">3</span>] = <span style="color: #D0372D;">34</span>, [<span style="color: #D0372D;">26</span>] = <span style="color: #D0372D;">5</span>}

<span style="color: #006FE0;">print</span>(<span style="color: #008000;">"tbl &#26368;&#22823;&#20540; "</span>, table_maxn(tbl))
<span style="color: #006FE0;">print</span>(<span style="color: #008000;">"tbl &#38271;&#24230;   "</span>, #tbl)

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">tbl &#26368;&#22823;&#20540;  34</span>
<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">tbl &#38271;&#24230;    3</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-ID-e0a477d7-479c-4aa4-9d00-f7f2b9407be3" class="outline-2">
<h2 id="ID-e0a477d7-479c-4aa4-9d00-f7f2b9407be3">Lua æ¨¡å—ä¸åŒ…</h2>
<div class="outline-text-2" id="text-ID-e0a477d7-479c-4aa4-9d00-f7f2b9407be3">
<p>
Lua çš„æ¨¡å—æ˜¯ç”±å˜é‡ã€å‡½æ•°ç­‰å·²çŸ¥å…ƒç´ ç»„æˆçš„ table
</p>
</div>

<div id="outline-container-org8cb2fb6" class="outline-3">
<h3 id="org8cb2fb6">require å‡½æ•°</h3>
<div class="outline-text-3" id="text-org8cb2fb6">
<div class="org-src-container">
<pre class="src src-lua"><span style="color: #006FE0;">require</span>(<span style="color: #008000;">"module"</span>)

<span style="color: #006FE0;">require</span> <span style="color: #008000;">"module"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9177b7f" class="outline-3">
<h3 id="org9177b7f">åŠ è½½æœºåˆ¶</h3>
<div class="outline-text-3" id="text-org9177b7f">
<p>
require ç”¨äºæœç´¢ Lua æ–‡ä»¶çš„è·¯å¾„æ˜¯å­˜æ”¾åœ¨å…¨å±€å˜é‡ package.path ä¸­ï¼Œå½“ Lua å¯åŠ¨åï¼Œä¼šä»¥ç¯å¢ƒå˜é‡ LUA<sub>PATH</sub> çš„å€¼æ¥åˆå§‹è¿™ä¸ªç¯å¢ƒå˜é‡ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°è¯¥ç¯å¢ƒå˜é‡ï¼Œåˆ™ä½¿ç”¨ä¸€ä¸ªç¼–è¯‘æ—¶å®šä¹‰çš„é»˜è®¤è·¯å¾„æ¥åˆå§‹åŒ–
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #8D8D84; font-style: italic;"># LUA_PATH</span>
<span style="color: #0000FF;">export</span> <span style="color: #BA36A5; font-style: italic;">LUA_PATH</span>=<span style="color: #008000;">"~/lua/?.lua;;"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6105dce" class="outline-3">
<h3 id="org6105dce">C åŒ…</h3>
<div class="outline-text-3" id="text-org6105dce">
<p>
C åŒ…åœ¨ä½¿ç”¨ä»¥å‰å¿…é¡»é¦–å…ˆåŠ è½½å¹¶è¿æ¥ï¼Œåœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­æœ€å®¹æ˜“çš„å®ç°æ–¹å¼æ˜¯é€šè¿‡åŠ¨æ€è¿æ¥åº“æœºåˆ¶
</p>

<p>
Lua åœ¨ä¸€ä¸ªå« loadlib çš„å‡½æ•°å†…æä¾›äº†æ‰€æœ‰çš„åŠ¨æ€è¿æ¥çš„åŠŸèƒ½ã€‚è¿™ä¸ªå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼šåº“çš„ç»å¯¹è·¯å¾„å’Œåˆå§‹åŒ–å‡½æ•°
</p>

<div class="org-src-container">
<pre class="src src-lua"><span style="color: #0000FF;">local</span> <span style="color: #BA36A5;">path</span> = <span style="color: #008000;">"/usr/local/lua/lib/libluasocket.so"</span>
<span style="color: #0000FF;">local</span> <span style="color: #BA36A5;">f</span> = loadlib(path, <span style="color: #008000;">"luaopen_socket"</span>)
</pre>
</div>

<p>
loadlib å‡½æ•°åŠ è½½æŒ‡å®šçš„åº“å¹¶ä¸”è¿æ¥åˆ° Luaï¼Œç„¶è€Œå®ƒå¹¶ä¸è°ƒç”¨åˆå§‹åŒ–å‡½æ•°ï¼Œè¿”å›åˆå§‹åŒ–å‡½æ•°ä½œä¸º Lua çš„å‡½æ•°
</p>

<div class="org-src-container">
<pre class="src src-lua"><span style="color: #0000FF;">local</span> <span style="color: #BA36A5;">path</span> = <span style="color: #008000;">"/usr/local/lua/lib/libluasocket.so"</span>
<span style="color: #0000FF;">local</span> <span style="color: #BA36A5;">f</span> = <span style="color: #006FE0;">assert</span>(loadlib(path, <span style="color: #008000;">"luaopen_socket"</span>))
f()
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-ID-83e40e27-ad20-4167-9486-d244c010cfc4" class="outline-2">
<h2 id="ID-83e40e27-ad20-4167-9486-d244c010cfc4">Lua å…ƒè¡¨ Metatable</h2>
<div class="outline-text-2" id="text-ID-83e40e27-ad20-4167-9486-d244c010cfc4">
<p>
å…è®¸æ”¹å˜ table çš„è¡Œä¸ºï¼Œæ¯ä¸ªè¡Œä¸ºå…³è”äº†å¯¹åº”çš„å…ƒæ–¹æ³•
</p>

<p>
â€œé‡è½½â€ï¼Œä¾‹å¦‚ Lua è¯•å›¾å¯¹ä¸¤ä¸ªè¡¨ç›¸åŠ æ—¶ï¼Œå…ˆæ£€æŸ¥ä¸¤è€…ä¹‹ä¸€æ˜¯å¦æœ‰å…ƒè¡¨ï¼Œä¹‹åæ£€æŸ¥æ˜¯å¦æœ‰ä¸€ä¸ªå« <code>__add</code> çš„å­—æ®µï¼Œè‹¥æ‰¾åˆ°ï¼Œåˆ™è°ƒç”¨å¯¹åº”çš„å€¼ã€‚
</p>

<p>
ç›¸å…³å‡½æ•°ï¼š
</p>
<ul class="org-ul">
<li><code>setmetatable(table, metatable)</code> å¯¹æŒ‡å®šè¡¨è®¾ç½®å…ƒè¡¨ï¼Œå¦‚æœå…ƒè¡¨ <code>metatable</code> ä¸­å­˜åœ¨ <code>__metatable</code> é”®å€¼ï¼Œæ­¤å‡½æ•°ä¼šå¤±è´¥</li>
<li><code>getmetatable(table)</code> è¿”å› table çš„å…ƒè¡¨</li>
</ul>
</div>

<div id="outline-container-orgfe8b866" class="outline-3">
<h3 id="orgfe8b866"><code>__index</code> å…ƒæ–¹æ³•</h3>
<div class="outline-text-3" id="text-orgfe8b866">
<p>
å®šä¹‰äº†è¡¨åœ¨ç´¢å¼•å¤±è´¥çš„æƒ…å†µä¸‹è¯¥æ€ä¹ˆåŠ
</p>

<p>
å…ƒè¡¨æœ€å¸¸ç”¨çš„é”®ï¼Œå½“é€šè¿‡é”®æ¥è®¿é—® table çš„æ—¶å€™ï¼Œå¦‚æœè¿™ä¸ªé”®æ²¡æœ‰å€¼ï¼Œé‚£ä¹ˆ Lua å°±ä¼šå¯»æ‰¾è¯¥ table çš„å…ƒè¡¨ä¸­çš„ <code>__index</code> é”®ï¼Œå¦‚æœ <code>__index</code> åŒ…å«ä¸€ä¸ªè¡¨æ ¼ï¼ŒLua ä¼šåœ¨è¡¨æ ¼ä¸­æŸ¥æ‰¾ç›¸åº”çš„é”®
</p>

<p>
å¦‚æœ <code>__index</code> åŒ…å«ä¸€ä¸ªå‡½æ•°çš„è¯ï¼ŒLua å°±ä¼šè°ƒç”¨é‚£ä¸ªå‡½æ•°ï¼Œtable å’Œé”®ä¼šä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°
</p>

<p>
<code>__index</code> å…ƒæ–¹æ³•æŸ¥çœ‹è¡¨ä¸­å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›ç»“æœä¸º <code>nil~ï¼›å¦‚æœå­˜åœ¨åˆ™ç”± ~__index</code> è¿”å›ç»“æœ
</p>

<p>
ğŸŒ°
</p>
<div class="org-src-container">
<pre class="src src-lua">mytable = <span style="color: #006FE0;">setmetatable</span>({key1 = <span style="color: #008000;">"value1"</span>}, {
  <span style="color: #006699;">__index</span> = <span style="color: #0000FF;">function</span>(<span style="color: #BA36A5;">mytable</span>, <span style="color: #BA36A5;">key</span>)
    <span style="color: #0000FF;">if</span> key == <span style="color: #008000;">"key2"</span> <span style="color: #0000FF;">then</span>
      <span style="color: #0000FF;">return</span> <span style="color: #008000;">"metatablevalue"</span>
    <span style="color: #0000FF;">else</span>
      <span style="color: #0000FF;">return</span> <span style="color: #D0372D;">nil</span>
    <span style="color: #0000FF;">end</span>
  <span style="color: #0000FF;">end</span>
})

<span style="color: #006FE0;">print</span>(mytable.key1, mytable.key2)

<span style="color: #8D8D84;">--</span><span style="color: #8D8D84; font-style: italic;">[[</span>
<span style="color: #8D8D84; font-style: italic;">  mytable &#30340; key2 &#23454;&#38469;&#24182;&#19981;&#23384;&#22312;</span>
<span style="color: #8D8D84; font-style: italic;">  &#20294; mytable &#23384;&#22312;&#20803;&#34920;</span>
<span style="color: #8D8D84; font-style: italic;">  &#22914;&#26524;&#20803;&#34920;&#23450;&#20041;&#20102; __index</span>
<span style="color: #8D8D84; font-style: italic;">  &#23601;&#20250;&#35843;&#29992;&#36825;&#20010; __index &#26041;&#27861;</span>
<span style="color: #8D8D84; font-style: italic;">  &#33509; __index &#20026; nil&#65292;&#21363;&#26410;&#23450;&#20041;</span>
<span style="color: #8D8D84; font-style: italic;">  &#36820;&#22238; nil</span>
<span style="color: #8D8D84; font-style: italic;">  &#33509; __index &#26159;&#19968;&#20010; table</span>
<span style="color: #8D8D84; font-style: italic;">  &#21017;&#22312;&#20803;&#34920;&#30340; table &#26597;&#25214;&#35813;&#32034;&#24341;</span>
<span style="color: #8D8D84; font-style: italic;">  &#33509; __index &#26159;&#19968;&#20010; &#20989;&#25968;</span>
<span style="color: #8D8D84; font-style: italic;">  &#21017;&#35843;&#29992;&#35813;&#20989;&#25968;&#24182;&#36820;&#22238;&#20989;&#25968;&#32467;&#26524;</span>

<span style="color: #8D8D84; font-style: italic;">  &#21487;&#20197;&#25226;&#20803;&#34920;&#29702;&#35299;&#19968;&#20010; table &#30340;&#25805;&#20316;&#25351;&#21335;</span>
<span style="color: #8D8D84; font-style: italic;">]]</span>

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">value1 metatablevalue</span>

mytable = <span style="color: #006FE0;">setmetatable</span>({key = <span style="color: #008000;">"value1"</span>}, {__index = {key2 = <span style="color: #008000;">"metatablevalue"</span>}})
</pre>
</div>
</div>
</div>

<div id="outline-container-org99046a8" class="outline-3">
<h3 id="org99046a8"><code>__newindex</code> å…ƒæ–¹æ³•</h3>
<div class="outline-text-3" id="text-org99046a8">
<p>
<code>__newindex</code> ç”¨æ¥å¯¹è¡¨æ›´æ–°ï¼Œå½“ç»™ table ä¸€ä¸ªç¼ºå°‘çš„ç´¢å¼•èµ‹å€¼ï¼Œè§£é‡Šå™¨å°±ä¼šæŸ¥æ‰¾ <code>__newindex</code> å…ƒæ–¹æ³•ï¼šå¦‚æœå­˜åœ¨å°±è°ƒç”¨è¿™ä¸ªå‡½æ•°è€Œä¸è¿›è¡Œèµ‹å€¼æ“ä½œ
</p>

<p>
ğŸŒ°
</p>
<div class="org-src-container">
<pre class="src src-lua">mymetatable = {}
mytable = setmetable({key1 = <span style="color: #008000;">"value1"</span>}, {__newindex = mymetatable})

<span style="color: #006FE0;">print</span>(mytable.key1)

mytable.newkey = <span style="color: #008000;">"newvalue"</span>
<span style="color: #006FE0;">print</span>(mytable.newkey, mymetable.newkey)

mytable.key1 = <span style="color: #008000;">"value11"</span>
<span style="color: #006FE0;">print</span>(mytable.key1, mymetatable.key1)

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">value</span>
<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">nil newvalue</span>
<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">value11 nil</span>
</pre>
</div>

<p>
ğŸŒ°
</p>
<div class="org-src-container">
<pre class="src src-lua">mytable = setmetable({key1 = <span style="color: #008000;">"value1"</span>}, {
  <span style="color: #006699;">__newindex</span> = <span style="color: #0000FF;">function</span>(<span style="color: #BA36A5;">mytable</span>, <span style="color: #BA36A5;">key</span>, <span style="color: #BA36A5;">value</span>)
    <span style="color: #006FE0;">rawset</span>(mytable, key, <span style="color: #008000;">"\""</span>..value..<span style="color: #008000;">"\""</span>)
  <span style="color: #0000FF;">end</span>
})

mytable.key1 = <span style="color: #008000;">"newvalue"</span>
mytable.key2 = <span style="color: #D0372D;">4</span>

<span style="color: #006FE0;">print</span>(mytable.key1, mytable.key2)

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">newvalue "4"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb10ab09" class="outline-3">
<h3 id="orgb10ab09"><code>__call</code> å…ƒæ–¹æ³•</h3>
<div class="outline-text-3" id="text-orgb10ab09">
<p>
åœ¨ Lua è°ƒç”¨ table çš„ä¸€ä¸ªå€¼æ—¶è°ƒç”¨
</p>
</div>
</div>

<div id="outline-container-org2639cba" class="outline-3">
<h3 id="org2639cba"><code>__string</code> å…ƒæ–¹æ³•</h3>
<div class="outline-text-3" id="text-org2639cba">
<p>
ä¿®æ”¹ table çš„è¾“å‡ºè¡Œä¸º
</p>
</div>
</div>

<div id="outline-container-org4fddd86" class="outline-3">
<h3 id="org4fddd86">å…¶ä»–å…ƒæ–¹æ³•</h3>
<div class="outline-text-3" id="text-org4fddd86">
<div class="org-src-container">
<pre class="src src-lua">__add    +
__sub    -
__mul    *
__div    /
__mod    %
__unm    -
__concat ..
__eq     ==
__lt     &lt;
__le     &lt;=
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-ID-1ef86fa1-bec0-428b-b1de-02a53a21fa8e" class="outline-2">
<h2 id="ID-1ef86fa1-bec0-428b-b1de-02a53a21fa8e">Lua ååŒç¨‹åº coroutine</h2>
<div class="outline-text-2" id="text-ID-1ef86fa1-bec0-428b-b1de-02a53a21fa8e">
<p>
Lua ååŒç¨‹åº (coroutine) ä¸çº¿ç¨‹æ¯”è¾ƒç±»ä¼¼ï¼šæ‹¥æœ‰ç‹¬ç«‹çš„å †æ ˆï¼Œç‹¬ç«‹çš„å±€éƒ¨å˜é‡ï¼Œç‹¬ç«‹çš„æŒ‡ä»¤æŒ‡é’ˆï¼ŒåŒæ—¶åˆä¸å…¶å®ƒååŒç¨‹åºå…±äº«å…¨å±€å˜é‡å’Œå…¶å®ƒå¤§éƒ¨åˆ†ä¸œè¥¿
</p>
</div>

<div id="outline-container-org6488042" class="outline-3">
<h3 id="org6488042">çº¿ç¨‹å’ŒååŒç¨‹åºåŒºåˆ«</h3>
<div class="outline-text-3" id="text-org6488042">
<p>
çº¿ç¨‹ä¸ååŒç¨‹åºçš„ä¸»è¦åŒºåˆ«åœ¨äºï¼Œä¸€ä¸ªå…·æœ‰å¤šä¸ªçº¿ç¨‹çš„ç¨‹åºå¯ä»¥åŒæ—¶è¿è¡Œå‡ ä¸ªçº¿ç¨‹ï¼Œè€ŒååŒç¨‹åºå´éœ€è¦å½¼æ­¤åä½œçš„è¿è¡Œï¼›åœ¨ä»»ä¸€æŒ‡å®šæ—¶åˆ»åªæœ‰ä¸€ä¸ªååŒç¨‹åºåœ¨è¿è¡Œï¼Œå¹¶ä¸”è¿™ä¸ªæ­£åœ¨è¿è¡Œçš„ååŒç¨‹åºåªæœ‰åœ¨æ˜ç¡®çš„è¢«è¦æ±‚æŒ‚èµ·çš„æ—¶å€™æ‰ä¼šè¢«æŒ‚èµ·
</p>

<p>
ååŒç¨‹åºæœ‰ç‚¹ç±»ä¼¼åŒæ­¥çš„å¤šçº¿ç¨‹
</p>
</div>
</div>

<div id="outline-container-orgedc5aa4" class="outline-3">
<h3 id="orgedc5aa4">åŸºæœ¬æ–¹æ³•</h3>
<div class="outline-text-3" id="text-orgedc5aa4">
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">æ–¹æ³•</th>
<th scope="col" class="org-left">å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">coroutine.create()</td>
<td class="org-left">åˆ›å»ºå¹¶è¿”å› coroutineï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°</td>
</tr>

<tr>
<td class="org-left">coroutine.resume()</td>
<td class="org-left">å¯åŠ¨/ç»§ç»­ coroutine</td>
</tr>

<tr>
<td class="org-left">coroutine.yield()</td>
<td class="org-left">æŒ‚èµ· coroutine</td>
</tr>

<tr>
<td class="org-left">coroutine.status()</td>
<td class="org-left">æŸ¥çœ‹ coroutine çŠ¶æ€ï¼ŒåŒ…å« dead, suspended, running</td>
</tr>

<tr>
<td class="org-left">coroutine.wrap()</td>
<td class="org-left">åˆ›å»º coroutineï¼Œè°ƒç”¨æ—¶è¿›å…¥ coroutine</td>
</tr>

<tr>
<td class="org-left">coroutine.running()</td>
<td class="org-left">è¿”å›æ­£åœ¨è¿è¡Œçš„ coroutine</td>
</tr>
</tbody>
</table>

<p>
resume å’Œ create é…åˆä½¿ç”¨æ—¶å°±å”¤é†’å‡½æ•°è°ƒç”¨
</p>

<p>
ğŸŒ° - ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜
</p>
<div class="org-src-container">
<pre class="src src-lua"><span style="color: #0000FF;">local</span> <span style="color: #BA36A5;">newProductor</span>

<span style="color: #0000FF;">function</span> <span style="color: #006699;">productor</span>()
  <span style="color: #0000FF;">local</span> <span style="color: #BA36A5;">i</span> = <span style="color: #D0372D;">0</span>
  <span style="color: #0000FF;">while</span> <span style="color: #D0372D;">true</span> <span style="color: #0000FF;">do</span>
    i = i + <span style="color: #D0372D;">1</span>
    send(i)
  <span style="color: #0000FF;">end</span>
<span style="color: #0000FF;">end</span>

fuction consumer()
  <span style="color: #0000FF;">while</span> <span style="color: #D0372D;">true</span> <span style="color: #0000FF;">do</span>
    <span style="color: #0000FF;">local</span> <span style="color: #BA36A5;">i</span> = receive()
    <span style="color: #006FE0;">print</span>(i)
  <span style="color: #0000FF;">end</span>
<span style="color: #0000FF;">end</span>

<span style="color: #0000FF;">function</span> <span style="color: #006699;">receive</span>()
  <span style="color: #0000FF;">local</span> <span style="color: #BA36A5;">status</span>, <span style="color: #BA36A5;">value</span> = <span style="color: #006FE0;">coroutine</span>.<span style="color: #006FE0;">resume</span>(newProductor)
  <span style="color: #0000FF;">return</span> value
<span style="color: #0000FF;">end</span>

<span style="color: #0000FF;">function</span> <span style="color: #006699;">send</span>(<span style="color: #BA36A5;">x</span>)
  <span style="color: #006FE0;">coroutine</span>.<span style="color: #006FE0;">yield</span>(x)
<span style="color: #0000FF;">end</span>

newProductor = <span style="color: #006FE0;">coroutine</span>.<span style="color: #006FE0;">create</span>(productor)
consumer()
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-ID-9f98a4a7-80be-4291-82ea-f383031c724b" class="outline-2">
<h2 id="ID-9f98a4a7-80be-4291-82ea-f383031c724b">Lua I/O</h2>
<div class="outline-text-2" id="text-ID-9f98a4a7-80be-4291-82ea-f383031c724b">
<ul class="org-ul">
<li>ç®€å•æ¨¡å¼ï¼šæ‹¥æœ‰ä¸€ä¸ªå½“å‰è¾“å…¥æ–‡ä»¶å’Œå½“å‰è¾“å‡ºæ–‡ä»¶ï¼Œå¹¶ä¸”æä¾›å¯¹è¿™äº›æ–‡ä»¶çš„ç›¸å…³æ“ä½œ</li>
<li>å®Œå…¨æ¨¡å¼ï¼šä½¿ç”¨å¤–éƒ¨çš„æ–‡ä»¶å¥æŸ„æ¥å®ç°ï¼Œä»¥ä¸€ç§é¢å‘å¯¹è±¡çš„å½¢å¼ï¼Œå°†æ‰€æœ‰çš„æ–‡ä»¶æ“ä½œå®šä¹‰ä¸ºæ–‡ä»¶å¥æŸ„çš„æ–¹æ³•</li>
</ul>

<div class="org-src-container">
<pre class="src src-lua">file = <span style="color: #006FE0;">io</span>.<span style="color: #006FE0;">open</span>(filename[, mode])
</pre>
</div>

<p>
mode:
</p>
<ul class="org-ul">
<li>r  åªè¯»ï¼Œæ–‡ä»¶å¿…é¡»å­˜åœ¨</li>
<li>w  åªå†™</li>
<li>a  é™„åŠ </li>
<li>r+ å¯è¯»å†™ï¼Œæ–‡ä»¶å¿…é¡»å­˜åœ¨</li>
<li>w+ å¯è¯»å†™</li>
<li>a+ å¯è¯»å†™</li>
<li>b  äºŒè¿›åˆ¶</li>
<li>+  å¯è¯»å†™</li>
</ul>
</div>


<div id="outline-container-org7cfd633" class="outline-3">
<h3 id="org7cfd633">ç®€å•æ¨¡å¼</h3>
<div class="outline-text-3" id="text-org7cfd633">
<p>
ğŸŒ°
</p>
<div class="org-src-container">
<pre class="src src-lua"><span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#20197;&#21482;&#35835;&#26041;&#24335;&#25171;&#24320;&#25991;&#20214;</span>
file = <span style="color: #006FE0;">io</span>.<span style="color: #006FE0;">open</span>(<span style="color: #008000;">"test.lua"</span>, <span style="color: #008000;">"r"</span>)

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#35774;&#32622;&#40664;&#35748;&#36755;&#20837;&#25991;&#20214;&#20026; test.lua</span>
<span style="color: #006FE0;">io</span>.<span style="color: #006FE0;">input</span>(file)

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#36755;&#20986;&#25991;&#20214;&#31532;&#19968;&#34892;</span>
<span style="color: #006FE0;">print</span>(<span style="color: #006FE0;">io</span>.<span style="color: #006FE0;">read</span>())

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#20851;&#38381;&#25171;&#24320;&#30340;&#25991;&#20214;</span>
<span style="color: #006FE0;">io</span>.<span style="color: #006FE0;">close</span>(file)

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#20197;&#38468;&#21152;&#30340;&#26041;&#24335;&#25171;&#24320;&#21482;&#20889;&#25991;&#20214;</span>
file = <span style="color: #006FE0;">io</span>.<span style="color: #006FE0;">open</span>(<span style="color: #008000;">"test.lua"</span>, <span style="color: #008000;">"a"</span>)

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#35774;&#32622;&#40664;&#35748;&#36755;&#20986;&#25991;&#20214;&#20026; test.lua</span>
<span style="color: #006FE0;">io</span>.<span style="color: #006FE0;">output</span>(file)

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#22312;&#25991;&#20214;&#26368;&#21518;&#19968;&#34892;&#28155;&#21152; Lua &#27880;&#37322;</span>
<span style="color: #006FE0;">io</span>.<span style="color: #006FE0;">write</span>(<span style="color: #008000;">"--  test.lua &#25991;&#20214;&#26411;&#23614;&#27880;&#37322;"</span>)

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#20851;&#38381;&#25171;&#24320;&#30340;&#25991;&#20214;</span>
<span style="color: #006FE0;">io</span>.<span style="color: #006FE0;">close</span>(file)
</pre>
</div>

<p>
read å‡½æ•°çš„å‚æ•°
</p>
<ul class="org-ul">
<li><code>"*n"</code>  è¯»å–ä¸€ä¸ªæ•°å­—å¹¶è¿”å›</li>
<li><code>"*a"</code>  ä»å½“å‰ä½ç½®è¯»å–æ•´ä¸ªæ–‡ä»¶</li>
<li><code>"*l</code>   è¯»å–ä¸‹ä¸€è¡Œ</li>
<li>number  è¿”å›ä¸€ä¸ªæŒ‡å®šå­—ç¬¦ä¸ªæ•°çš„å­—ç¬¦ä¸²ï¼Œæˆ–åœ¨ EOF æ—¶è¿”å› nil</li>
</ul>

<p>
io.tmpfile() è¿”å›ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶å¥æŸ„ï¼Œè¯¥æ–‡ä»¶ä»¥æ›´æ–°æ¨¡å¼æ‰“å¼€ï¼Œç¨‹åºç»“æŸæ—¶è‡ªåŠ¨åˆ é™¤
</p>

<p>
io.type(file) æ£€æµ‹ obj æ˜¯å¦æ˜¯ä¸€ä¸ªå¯ç”¨çš„æ–‡ä»¶å¥æŸ„
</p>

<p>
io.flush() å‘æ–‡ä»¶å†™å…¥ç¼“å†²ä¸­çš„æ‰€æœ‰æ•°æ®
</p>

<p>
io.lines(optional file name) è¿”å›ä¸€ä¸ªè¿­ä»£å‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨è·å–æ–‡ä»¶ä¸­ä¸€è¡Œå†…å®¹
</p>
</div>
</div>

<div id="outline-container-org44f7a7c" class="outline-3">
<h3 id="org44f7a7c">å®Œå…¨æ¨¡å¼</h3>
<div class="outline-text-3" id="text-org44f7a7c">
<p>
åŒä¸€æ—¶é—´å¤„ç†å¤šä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨ <a href="function_name">function_name</a> æ¥ä»£æ›¿ io.function<sub>name</sub> æ–¹æ³•
</p>

<div class="org-src-container">
<pre class="src src-lua"><span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#20197;&#21482;&#35835;&#26041;&#24335;&#25171;&#24320;&#25991;&#20214;</span>
file = <span style="color: #006FE0;">io</span>.<span style="color: #006FE0;">open</span>(<span style="color: #008000;">"test.lua"</span>, <span style="color: #008000;">"r"</span>)

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#36755;&#20986;&#25991;&#20214;&#31532;&#19968;&#34892;</span>
<span style="color: #006FE0;">print</span>(file:read())

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#20851;&#38381;&#25171;&#24320;&#30340;&#25991;&#20214;</span>
file:close()

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#20197;&#38468;&#21152;&#30340;&#26041;&#24335;&#25171;&#24320;&#21482;&#20889;&#25991;&#20214;</span>
file = <span style="color: #006FE0;">io</span>.<span style="color: #006FE0;">open</span>(<span style="color: #008000;">"test.lua"</span>, <span style="color: #008000;">"a"</span>)

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#22312;&#25991;&#20214;&#26368;&#21518;&#19968;&#34892;&#28155;&#21152; Lua &#27880;&#37322;</span>
file:write(<span style="color: #008000;">"--test"</span>)

<span style="color: #8D8D84;">-- </span><span style="color: #8D8D84; font-style: italic;">&#20851;&#38381;&#25171;&#24320;&#30340;&#25991;&#20214;</span>
file:close()
</pre>
</div>

<p>
æ–¹æ³•ï¼š
</p>

<p>
<a href="seek">seek</a>(optional whence, optional offset) è®¾ç½®å’Œè·å–å½“å‰æ–‡ä»¶ä½ç½®ï¼ŒæˆåŠŸåˆ™è¿”å›æœ€ç»ˆçš„æ–‡ä»¶ä½ç½®ï¼Œå¤±è´¥åˆ™è¿”å› nil åŠ é”™è¯¯ä¿¡æ¯
</p>

<p>
whence =
</p>
<ul class="org-ul">
<li>&ldquo;set&rdquo; ä»æ–‡ä»¶å¤´å¼€å§‹</li>
<li>&ldquo;cur&rdquo; ä»å½“å‰ä½ç½®å¼€å§‹</li>
<li>&ldquo;end&rdquo; ä»æ–‡ä»¶å°¾å¼€å§‹</li>
</ul>

<p>
offset é»˜è®¤ä¸º 0
</p>

<p>
<a href="flush()">flush()</a>
</p>

<p>
<a href="lines">lines</a>(optional file name)
</p>
</div>
</div>
</div>


<div id="outline-container-ID-56dfdc61-5be3-40b1-8825-c2523bb2f006" class="outline-2">
<h2 id="ID-56dfdc61-5be3-40b1-8825-c2523bb2f006">Lua é”™è¯¯å¤„ç†</h2>
<div class="outline-text-2" id="text-ID-56dfdc61-5be3-40b1-8825-c2523bb2f006">
</div>
<div id="outline-container-org526fa33" class="outline-3">
<h3 id="org526fa33">assert()</h3>
<div class="outline-text-3" id="text-org526fa33">
<p>
assert(argument, message)
</p>

<p>
assert é¦–å…ˆæ£€æŸ¥ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè‹¥æ²¡é—®é¢˜ï¼Œassert ä¸åšä»»ä½•äº‹æƒ…ï¼›å¦åˆ™ï¼Œassert ä»¥ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºé”™è¯¯ä¿¡æ¯æŠ›å‡º
</p>
</div>
</div>

<div id="outline-container-orgddac02b" class="outline-3">
<h3 id="orgddac02b">error()</h3>
<div class="outline-text-3" id="text-orgddac02b">
<p>
error(message[, level])
</p>

<p>
ç»ˆæ­¢æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°ï¼Œå¹¶è¿”å› message çš„å†…å®¹ä½œä¸ºé”™è¯¯ä¿¡æ¯
</p>

<p>
level å‚æ•°æŒ‡ç¤ºè·å¾—é”™è¯¯çš„ä½ç½®
</p>
<ul class="org-ul">
<li>1 é»˜è®¤ï¼Œä¸ºè°ƒç”¨ error çš„ä½ç½®ï¼Œæ–‡ä»¶ + è¡Œå·</li>
<li>2 æŒ‡å‡ºé‚£ä¸ªè°ƒç”¨ error çš„å‡½æ•°</li>
<li>0 ä¸æ·»åŠ é”™è¯¯ä½ç½®ä¿¡æ¯</li>
</ul>
</div>
</div>

<div id="outline-container-orgffd9c1a" class="outline-3">
<h3 id="orgffd9c1a">pcall, xpcall</h3>
<div class="outline-text-3" id="text-orgffd9c1a">
<p>
pcall æ¥æ”¶ä¸€ä¸ªå‡½æ•°å’Œè¦ä¼ é€’ç»™åè€…çš„å‚æ•°ï¼Œå¹¶æ‰§è¡Œï¼Œè¿”å›å€¼ true / false, errorinfo
</p>

<div class="org-src-container">
<pre class="src src-lua"><span style="color: #0000FF;">if</span> <span style="color: #006FE0;">pcall</span>(function_name) <span style="color: #0000FF;">then</span>

<span style="color: #0000FF;">else</span>

<span style="color: #0000FF;">end</span>
</pre>
</div>

<p>
xpcall ç›¸æ¯”ä¸ pcall æ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°ï¼šä¸€ä¸ªé”™è¯¯å¤„ç†å‡½æ•°ï¼Œå½“é”™è¯¯å‘ç”Ÿæ—¶ï¼ŒLua ä¼šåœ¨è°ƒç”¨æ ˆå±•å¼€ (unwind) å‰è°ƒç”¨é”™è¯¯å¤„ç†å‡½æ•°
</p>
</div>
</div>

<div id="outline-container-orgc356136" class="outline-3">
<h3 id="orgc356136">debug åº“</h3>
</div>
</div>


<div id="outline-container-ID-edbcb6f6-313a-4e7a-845d-e70a8184c73c" class="outline-2">
<h2 id="ID-edbcb6f6-313a-4e7a-845d-e70a8184c73c">Lua åƒåœ¾å›æ”¶</h2>
<div class="outline-text-2" id="text-ID-edbcb6f6-313a-4e7a-845d-e70a8184c73c">
<p>
Lua è¿è¡Œäº†ä¸€ä¸ªåƒåœ¾æ”¶é›†å™¨æ¥æ”¶é›†æ‰€æœ‰æ­»å¯¹è±¡ï¼Œå®ç°äº†ä¸€ä¸ªå¢é‡æ ‡è®°-æ‰«ææ”¶é›†å™¨ã€‚ä½¿ç”¨ä¸¤ä¸ªæ ‡è®°æ¥æ§åˆ¶åƒåœ¾æ”¶é›†å¾ªç¯ï¼Œå•ä½éƒ½æ˜¯ç™¾åˆ†æ•°
</p>

<ul class="org-ul">
<li>åƒåœ¾æ”¶é›†å™¨é—´æ­‡ç‡    200 è¡¨ç¤º 2 å€å†…å­˜æ—¶å¼€å§‹æ–°çš„å¾ªç¯</li>
<li>åƒåœ¾æ”¶é›†å™¨æ­¥è¿›å€ç‡  200 è¡¨ç¤ºä»¥å†…å­˜åˆ†é…çš„ 2 å€é€Ÿå·¥ä½œ</li>
</ul>

<p>
collectgarbage([opt [, arg]])
</p>

<p>
opt =
</p>
<ul class="org-ul">
<li>&ldquo;collect&rdquo;  åšä¸€æ¬¡å®Œæ•´çš„åƒåœ¾å¾ªç¯</li>
<li>&ldquo;count&rdquo;    ä»¥ K å­—èŠ‚æ•°ä¸ºå•ä½è¿”å› Lua ä½¿ç”¨çš„æ€»å†…å­˜æ•°</li>
<li>&ldquo;restart&rdquo;  é‡å¯åƒåœ¾æ”¶é›†å™¨çš„è‡ªåŠ¨è¿è¡Œ</li>
<li>&ldquo;setpause&rdquo; å°† arg è®¾ä¸ºæ”¶é›†å™¨çš„é—´æ­‡ç‡ï¼Œè¿”å›é—´æ­‡ç‡çš„å‰å€¼</li>
<li>&ldquo;step&rdquo;     å•æ­¥è¿è¡Œåƒåœ¾æ”¶é›†å™¨</li>
<li>&ldquo;stop&rdquo;     åœæ­¢åƒåœ¾æ”¶é›†å™¨çš„è¿è¡Œ</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">

                     Theme
                     <a href="https://github.com/fniessen/org-html-themes" target="_blank">bigblow/readtheorg</a>
                     by
                     <a href="https://github.com/fniessen" target="_blank">fniessen</a>
                     <br>
                     <a href="https://beian.miit.gov.cn" target="_blank">æ¹˜ICPè¯019014083å·</a>
</div>
</body>
</html>