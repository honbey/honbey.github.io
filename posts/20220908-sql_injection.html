<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-09-08 Thu 20:11 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SQL Injection</title>
<meta name="author" content="Honbey Zhang" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="../resources/orgmode.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/style.css" type="text/css"/>
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">SQL Injection</h1>
</header>
<div id="outline-container-ID-165a516f-c616-40fe-8438-cb548d4337de" class="outline-2">
<h2 id="ID-165a516f-c616-40fe-8438-cb548d4337de">SQL 注入</h2>
<div class="outline-text-2" id="text-ID-165a516f-c616-40fe-8438-cb548d4337de">
<p>
本质原因：允许用户拼接 SQL 语句。
</p>

<blockquote>
<p>
mybits 尽量使用 #，若使用 $ 可导致 SQL 注入<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>，如
</p>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #D0372D;">@Select</span>(<span style="color: #008000;">"select * from users where username = '${username}'"</span>)
<span style="color: #6434A3;">List</span>&lt;<span style="color: #6434A3;">User</span>&gt; <span style="color: #006699;">findByUserNameVuln01</span>(<span style="color: #D0372D;">@Param</span>(<span style="color: #008000;">"username"</span>) <span style="color: #6434A3;">String</span> <span style="color: #BA36A5;">username</span>);
</pre>
</div>

<p>
模糊查询使用 <code>LIKEconcat(‘%’,#{_parameter}, ‘%’)</code> ，如果是 <code>LIKE '%{_parameter}%'</code> 会让攻击者可以闭合引号实现 SQL 注入。
</p>
</blockquote>
</div>

<div id="outline-container-ID-331b6934-6219-4735-9865-639defd013e4" class="outline-3">
<h3 id="ID-331b6934-6219-4735-9865-639defd013e4">整型注入</h3>
<div class="outline-text-3" id="text-ID-331b6934-6219-4735-9865-639defd013e4">
<p>
<code>?id=1 #</code>
</p>
</div>
</div>
<div id="outline-container-ID-c6d74b72-f72e-4320-be57-8ef072295920" class="outline-3">
<h3 id="ID-c6d74b72-f72e-4320-be57-8ef072295920">字符型注入</h3>
<div class="outline-text-3" id="text-ID-c6d74b72-f72e-4320-be57-8ef072295920">
<p>
<code>?id='1' --</code>
</p>

<p>
需要注意拼接引号，使得语句完整闭合，可以使用注释符、引号、括号、转义符等。
</p>
</div>
</div>

<div id="outline-container-orgc822304" class="outline-3">
<h3 id="orgc822304">盲注</h3>
<div class="outline-text-3" id="text-orgc822304">
<p>
布尔型：只有两种结果，要么成功，要么失败。
</p>

<p>
时间型：使用特定的函数如 sleep, <a href="20220821-database.html#ID-a7624498-19b7-4749-9780-cc0ee3c74467">benchmark</a> 等判断成功或失败。
</p>

<p>
判断字段数： <code>order by &lt;int&gt;</code> ，超过哪个数字就不正常时说明就有多少个字段。
</p>
</div>
</div>
<div id="outline-container-org704ef0d" class="outline-3">
<h3 id="org704ef0d">显注</h3>
<div class="outline-text-3" id="text-org704ef0d">
<p>
执行 SQL 语句后会显示相应的结果或错误信息。
</p>
</div>
</div>
</div>

<div id="outline-container-ID-3155f192-cff7-4a54-83e3-3681e2752358" class="outline-2">
<h2 id="ID-3155f192-cff7-4a54-83e3-3681e2752358">SqlMap</h2>
<div class="outline-text-2" id="text-ID-3155f192-cff7-4a54-83e3-3681e2752358">
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://my.oschina.net/u/4090830/blog/5569859">渗透攻防Web篇-深入浅出SQL注入 - 京东云开发者的个人空间 - OSCHINA - 中文开源技术交流社区</a>
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<a href="https://beian.miit.gov.cn" target="_blank">湘ICP证019014083号</a>
</div>
</body>
</html>
