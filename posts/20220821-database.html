<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-09-12 Mon 22:21 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Database</title>
<meta name="author" content="Honbey Zhang" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="../resources/orgmode.css" type="text/css"/>
                     <link rel="stylesheet" href="../resources/style.css" type="text/css"/>
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">Database</h1>
</header>
<div id="outline-container-ID-557eccab-2519-4dab-9bc1-9df54a593b65" class="outline-2">
<h2 id="ID-557eccab-2519-4dab-9bc1-9df54a593b65">Database - 数据库</h2>
<div class="outline-text-2" id="text-ID-557eccab-2519-4dab-9bc1-9df54a593b65">
</div>
</div>

<div id="outline-container-ID-d0fbd46e-6bb2-4834-a115-524acfb9e717" class="outline-2">
<h2 id="ID-d0fbd46e-6bb2-4834-a115-524acfb9e717">键值数据库</h2>
<div class="outline-text-2" id="text-ID-d0fbd46e-6bb2-4834-a115-524acfb9e717">
</div>
<div id="outline-container-orgc353a4a" class="outline-3">
<h3 id="orgc353a4a">基于 <a href="20220908-distributed_architecture.html#ID-d9245f65-7046-42d9-b6b7-ca5bcc5cfb60">Raft 算法</a>的分布式数据库 - <a href="20220811-etcd.html#ID-f92dece7-4ba1-4e14-bdd4-545a0f6a67e1">ETCD</a></h3>
</div>
<div id="outline-container-orgd8c017c" class="outline-3">
<h3 id="orgd8c017c">使用内存的高性能缓存数据库 - <a href="20220730-redis.html#ID-0f357c15-ef76-4958-857d-fc30339c5f9c">Redis</a></h3>
</div>
</div>
<div id="outline-container-ID-11febd3d-29e6-4273-9d72-f7d1cbb1ac9c" class="outline-2">
<h2 id="ID-11febd3d-29e6-4273-9d72-f7d1cbb1ac9c">关系型数据库</h2>
<div class="outline-text-2" id="text-ID-11febd3d-29e6-4273-9d72-f7d1cbb1ac9c">
</div>
<div id="outline-container-ID-59428a07-fcb2-475d-9512-3571be6aef0f" class="outline-3">
<h3 id="ID-59428a07-fcb2-475d-9512-3571be6aef0f">SQL</h3>
<div class="outline-text-3" id="text-ID-59428a07-fcb2-475d-9512-3571be6aef0f">
<p>
一些特殊字符：
</p>
<pre class="example">
`     用于表示数据库名、表名、字段名
&amp;     且
||    连接符
@     定义变量
%     模糊查询
.     通配符
&lt;&gt;    不等于
#     注释
/* */ 注释
</pre>

<p>
数据库操作：
</p>
<div class="org-src-container">
<pre class="src src-sql"># &#21019;&#24314;&#25968;&#25454;&#24211;
<span style="color: #0000FF;">create</span> &lt;database&gt;;

# &#20999;&#25442;&#25968;&#25454;&#24211;
use &lt;database&gt;;

# &#26597;&#30475;&#25968;&#25454;&#24211;
show databases;

# &#20462;&#25913;&#25968;&#25454;&#24211;
<span style="color: #0000FF;">alter</span> database &lt;database&gt; [<span style="color: #0000FF;">option</span>];

# &#21024;&#38500;&#25968;&#25454;&#24211;
<span style="color: #0000FF;">drop</span> database &lt;database&gt;
</pre>
</div>

<p>
表操作：
</p>
<div class="org-src-container">
<pre class="src src-sql"># &#21019;&#24314;&#34920;
<span style="color: #0000FF;">create</span> <span style="color: #0000FF;">table</span> [database].&lt;<span style="color: #0000FF;">table_name</span>&gt; (
    &lt;column1&gt; &lt;datatype&gt; [<span style="color: #0000FF;">primary</span> <span style="color: #0000FF;">key</span>] [autoincrement] [<span style="color: #0000FF;">not</span> <span style="color: #0000FF;">null</span>],
    &lt;column2&gt; &lt;datatype&gt; [<span style="color: #0000FF;">not</span> <span style="color: #0000FF;">null</span>] [<span style="color: #0000FF;">default</span> &lt;<span style="color: #0000FF;">value</span>&gt;],
    [<span style="color: #0000FF;">foreign</span> <span style="color: #0000FF;">key</span>(&lt;<span style="color: #0000FF;">column</span>&gt;) <span style="color: #0000FF;">references</span> &lt;<span style="color: #0000FF;">table_name</span>&gt;.&lt;<span style="color: #0000FF;">column</span>&gt;]
);

# &#21024;&#38500;&#34920;
<span style="color: #0000FF;">drop</span> <span style="color: #0000FF;">table</span> [database].&lt;<span style="color: #0000FF;">table_name</span>&gt;;

# &#25554;&#20837;&#35760;&#24405;
<span style="color: #0000FF;">insert</span> <span style="color: #0000FF;">into</span> &lt;<span style="color: #0000FF;">table_name</span>&gt; (&lt;column1&gt;[, &lt;column2&gt;, ...])
    <span style="color: #0000FF;">values</span>(&lt;value1&gt;[, &lt;value2&gt;, ...]);

# &#21024;&#38500;&#35760;&#24405;
<span style="color: #0000FF;">delete</span> <span style="color: #0000FF;">from</span> &lt;<span style="color: #0000FF;">table_name</span>&gt; [<span style="color: #0000FF;">where</span> &lt;condition&gt;];

# &#26356;&#26032;&#35760;&#24405;
<span style="color: #0000FF;">update</span> &lt;<span style="color: #0000FF;">table_name</span>&gt; <span style="color: #0000FF;">set</span>
    &lt;column1=value1&gt;,
    [column2=value2],
    ...
[<span style="color: #0000FF;">where</span> &lt;condition&gt;];
</pre>
</div>
</div>

<div id="outline-container-org8dc6478" class="outline-4">
<h4 id="org8dc6478">select 语句</h4>
</div>
</div>
<div id="outline-container-ID-787cf0fd-8725-403d-b115-a26c87d7dfcc" class="outline-3">
<h3 id="ID-787cf0fd-8725-403d-b115-a26c87d7dfcc">ORM</h3>
<div class="outline-text-3" id="text-ID-787cf0fd-8725-403d-b115-a26c87d7dfcc">
<p>
Object-Relationship Mapping: 对象关系映射，将对关系型数据库的操作规范化，防止注入。ORM 的作用是在关系型数据库和业务实体对象之间作一个映射，在具体的操作业务对象的时候，就不需要再直接编写复杂的 SQL 语句，只需操作对象的属性和方法。
</p>
</div>
</div>
<div id="outline-container-ID-6df84a61-43bc-421e-8f78-435567f0ed2b" class="outline-3">
<h3 id="ID-6df84a61-43bc-421e-8f78-435567f0ed2b">My<a href="#ID-59428a07-fcb2-475d-9512-3571be6aef0f">SQL</a></h3>
<div class="outline-text-3" id="text-ID-6df84a61-43bc-421e-8f78-435567f0ed2b">
<p>
瑞典 MySQL AB 公司开发，后被收购，现属于 Oracle 旗下产品。MySQL 是最流行的关系型数据库管理系统之一。有开源免费的社区版，也有商业收费版本。
</p>

<p>
注释符号：
</p>
<pre class="example">
# ...  标准 SQL 语法不支持这种
-- ... 注意两个 dash 后要有一个 空格，标准 SQL 语法不需要接空格
/* ... */
</pre>
</div>

<div id="outline-container-ID-15806e05-94cb-4600-9b95-bf122ea54066" class="outline-4">
<h4 id="ID-15806e05-94cb-4600-9b95-bf122ea54066">MySQL information<sub>schema</sub></h4>
<div class="outline-text-4" id="text-ID-15806e05-94cb-4600-9b95-bf122ea54066">
<p>
mysql 5.0 以上中有一个重要的系统数据库 information<sub>schema</sub>，通过此数据库可访问 mysql 中存在的数据库名、表名、字段名等元数据。
有三个表可用于 sqli :
</p>
<ol class="org-ol">
<li>information<sub>schema.columns</sub>
<ul class="org-ul">
<li>table<sub>schema</sub> 数据库名</li>
<li>table<sub>name</sub>   表名</li>
<li>column<sub>name</sub>  列名</li>
</ul></li>
<li>information<sub>schema.tables</sub>
<ul class="org-ul">
<li>table<sub>schema</sub> 数据库名</li>
<li>table<sub>name</sub>   表名</li>
</ul></li>
<li>information<sub>schema.schemata</sub>
<ul class="org-ul">
<li>schema<sub>name</sub>  数据库名</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-ID-a7624498-19b7-4749-9780-cc0ee3c74467" class="outline-4">
<h4 id="ID-a7624498-19b7-4749-9780-cc0ee3c74467">MySQL builtin function</h4>
<div class="outline-text-4" id="text-ID-a7624498-19b7-4749-9780-cc0ee3c74467">
<ul class="org-ul">
<li>length(str)           返回字符串的长度</li>
<li>substr(str, pos, len) 从 pos 位置截取 len 长度的子字符串，索引从 1 开始</li>
<li>mid(str, pos, len)    同 substr()</li>
<li>ascii(str)            返回字符串 str 最左边字符的 <a href="20220708-programming.html#ID-89f5c9f3-226a-462c-b2ac-46b3ee0c06f6">ASCII</a> 码</li>
<li>ord(str)              将字符或 boolean 转为 <a href="20220708-programming.html#ID-89f5c9f3-226a-462c-b2ac-46b3ee0c06f6">ASCII</a> 码</li>
<li>if(a, b, c)           a 为 condition ，为 true 返回 b，为 false 返回 c</li>
<li>group<sub>concat</sub>()</li>
<li>benchmark(cnt, sql)   用于测试函数或者表达式的执行速度
<ul class="org-ul">
<li>执行 True False NULL 均可</li>
<li>仅支持单行单列的结果，否则报错</li>
<li>内部 sql 失败，benchmark 也失败</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orga22c430" class="outline-3">
<h3 id="orga22c430">SQLite</h3>
<div class="outline-text-3" id="text-orga22c430">
<p>
轻量级的关系数据库。
</p>

<p>
查看所有表格： <code>.tables</code>
</p>

<p>
常用配置：
</p>
<pre class="example">
.header on
.mode columb
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<a href="https://beian.miit.gov.cn" target="_blank">湘ICP证019014083号</a>
</div>
</body>
</html>
